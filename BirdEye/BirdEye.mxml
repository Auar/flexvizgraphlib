<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:flexlib="http://code.google.com/p/flexlib/"
	xmlns:visualize="org.un.birdeye.visualize.*"
	xmlns:modules="org.un.birdeye.record.*"
	xmlns:about="org.un.birdeye.about.*"
	backgroundGradientColors="[#cccccc, #666666]"
	layout="absolute" creationComplete="tbMain.removeChild(aboutCnvs);"
	width="100%" height="100%"
	  >
<!--  JB -->
<mx:Script>
	<![CDATA[
       	import flexlib.events.TabReorderEvent;
        import flexlib.controls.SuperTabBar;
        import flexlib.containers.SuperTabNavigator;
        import flexlib.controls.tabBarClasses.SuperTab;
        import flexlib.skins.TabPopUpButtonSkin;
        
        // A nested XML collection for Measure and Report dataProviding
        public var gTreeXML:XML;
        
        // Handler for About Button
        private function clickMenuButtonHandler(event:Event):void {
			var buttonID:String = event.target.id;
			var selected:Boolean = event.target.selected;
			
			switch (buttonID) {
				case "btnAbout":
					if (selected) {
						tbMain.addChild(aboutCnvs);
						tbMain.selectedChild = aboutCnvs;
					} else
						tbMain.removeChild(aboutCnvs);
					break;
				
				default:
					// trace("default");
			}
		}
       
	]]>
</mx:Script>

<mx:Script source="/org/un/birdeye/sql/DAO.as" />
<mx:Script source="/org/un/birdeye/record/record.as" />
<mx:Script source="org/un/birdeye/ui/SaveSnapShot.as" />

<mx:Style source="/org/un/birdeye/style/css/main.css" />

<mx:ArrayCollection id="filterNodes" source="{dpNodes}"/>
<mx:ArrayCollection id="filterEdges" source="{dpEdgeView}"/>

<mx:VBox width="100%" height="100%" horizontalAlign="center" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5" >
	<mx:ApplicationControlBar width="99%" height="38"  >
	
	<mx:HBox width="100%" height="100%" verticalAlign="top">
	
	<mx:Image source="@Embed(source='/org/un/birdeye/images/ui/birdeye.png')" width="32" height="32" verticalAlign="middle" />
	
	
   	<mx:VBox width="100%" height="100%" verticalGap="0" >
	<mx:Label id="logo" width="100%" height="17" text="BirdEye: EXPLORE, DISCOVER, UNDERSTAND..." fontSize="11" textAlign="left" bottom="1" paddingRight="5" />
	
	<mx:HRule width="100%" />
	
	</mx:VBox>
	
	<mx:Button 
			toolTip="Take Snapshot and save as image file"
			icon="@Embed(source='/org/un/birdeye/images/ui/camera.png')" 
  			id="btnSnapShot"
  			click="openWindow(event)"
  			/>
	<mx:Button 
			toolTip="About..."
			icon="@Embed(source='/org/un/birdeye/images/ui//info.png')" 
  			id="btnAbout" selected="false"
  			toggle="true" click="clickMenuButtonHandler(event);"
  			/>
  			
	</mx:HBox>
	</mx:ApplicationControlBar>
	
	<flexlib:SuperTabNavigator  x="10" y="10" minTabWidth="100" width="99%" height="100%" closePolicy="{SuperTab.CLOSE_NEVER}" id="tbMain" selectedIndex="0" paddingBottom="5" paddingLeft="5" paddingRight="5" creationPolicy="all" >
	
		<!-- Visualization tab -->
		<mx:Canvas id="vizCnvs" label="Visualize" icon="@Embed('/org/un/birdeye/images/ui//visualization.png')" width="100%" height="100%" >
			<visualize:Visualize width="100%" height="100%" preinitialize="dbInit()" />		
		</mx:Canvas>
			
		<!-- Don't have time to complete 
		<mx:Canvas id="dashboardCnvs" label="Measure" icon="@Embed('/org/un/birdeye/images/ui/chart.png')" width="100%" height="100%" >
			<measure:Measure width="100%" height="100%" />				
		</mx:Canvas>
		-->
		
		<!-- Node tab -->
		<mx:Canvas id="nodeCnvs" label="Nodes" icon="@Embed('/org/un/birdeye/images/ui//aLookups.png')" width="100%" height="100%" creationComplete="onInit();"  >
			<mx:Accordion width="100%" height="100%" id="nodeControl" creationPolicy="all" >
					<!-- Index 0 of Accordion, nodeControl -->
					<mx:VBox width="100%" height="100%" label="Node List" >
						<mx:ApplicationControlBar width="100%" height="35" >
						<!-- Search panel -->
						<mx:HBox icon="@Embed('org/un/birdeye/images/ui/hint.png')" verticalAlign="middle" paddingLeft="5" paddingRight="5" >
							<mx:Image source="@Embed(source='/org/un/birdeye/images/ui/search.png')" />
							<mx:Label text="Title"/>
							<mx:TextInput 
      	 						id="NodeNameFilter" 
       	 						width="100%"
         						change="filterNodes.refresh()"/>
							<mx:Label text="Description"/>
							<mx:TextInput id="NodeDescFilter" change="filterNodes.refresh()"/>
						</mx:HBox>
						<mx:Button toolTip="This will take you to a new record form" icon="@Embed('org/un/birdeye/images/ui/add.png')" label="New" click="addNode(event);"/>
						</mx:ApplicationControlBar>
						<mx:DataGrid id="dgNodeRequest" dataProvider="{filterNodes}" wordWrap="true" variableRowHeight="true" width="100%" height="100%" >
						<mx:columns>
						<mx:DataGridColumn headerText="ID" width="65" dataField="NodeID" />
						<mx:DataGridColumn headerText="Title" dataField="NodeName" />
						<mx:DataGridColumn headerText="Node Description" dataField="NodeDescription" />
						<mx:DataGridColumn headerText="NodeType" width="125" dataField="NodeType"/>
						<mx:DataGridColumn minWidth="160" itemRenderer="org.un.birdeye.record.dgNodeControlBtns" width="160" />
						</mx:columns>
					</mx:DataGrid>
				</mx:VBox>
				<!-- Index 1 of Accordion, viewControl -->
				<modules:Nodes id="nodeModule" /> 
			</mx:Accordion>
	
	
		<!-- Edges tab -->	
		</mx:Canvas>
		<mx:Canvas id="edgeCnvs" label="Links" icon="@Embed('/org/un/birdeye/images/ui/links.png')" width="100%" height="100%" >
			<mx:Accordion width="100%" height="100%" id="edgeControl" creationPolicy="all" >
	 			<!-- Index 0 of Accordion, edgeControl -->
	 			<mx:VBox label="Edge List" width="100%" height="100%" >
 					<mx:ApplicationControlBar width="100%" height="35" >
 					<!-- Search panel -->
 					<mx:HBox icon="@Embed('org/un/birdeye/images/ui/hint.png')" paddingLeft="5" paddingRight="5" id="edgeFilterBox" name="edgeFilterBox" verticalAlign="middle">
						<mx:Image source="@Embed(source='/org/un/birdeye/images/ui/search.png')" />
						<mx:Label text="FromName:"/>
						<mx:TextInput 
      						id="EdgeSourceFilter" 
       	 					width="100%"
         					change="filterEdges.refresh()"/>
						<mx:Label text="ToName:"/>
						<mx:TextInput id="EdgeTargetFilter" change="filterEdges.refresh()"/>
					</mx:HBox>
					<mx:Button toolTip="This will take you to a new record form" icon="@Embed('org/un/birdeye/images/ui/add.png')" label="New" click="addEdge(event);"/>
 					</mx:ApplicationControlBar>
					<mx:DataGrid dataProvider="{filterEdges}" id="dgEdgeRequest" wordWrap="true" variableRowHeight="true" width="100%" height="100%" >
						<mx:columns>
							<mx:DataGridColumn headerText="From" width="55" dataField="EdgeSource" />
							<mx:DataGridColumn headerText="FromName" dataField="SourceName" />
							<mx:DataGridColumn headerText="To" width="55" dataField="EdgeTarget"/>
							<mx:DataGridColumn headerText="ToName" dataField="TargetName" />
							<mx:DataGridColumn headerText="AssociationType" dataField="AssociationType" />
							<mx:DataGridColumn headerText="AssociationDesc" dataField="AssociationDescription" />
							<mx:DataGridColumn minWidth="160" itemRenderer="org.un.birdeye.record.dgEdgeControlBtns" width="160" />
						</mx:columns>
					</mx:DataGrid>
 				</mx:VBox>
 				<!-- Index 1 of Accordion, edgeControl -->
 				<modules:Edges id="edgeModule" />
			</mx:Accordion>
		</mx:Canvas>
		
		<!-- Don't have time to complete 
		<mx:Canvas id="reportCnvs" label="Report" icon="@Embed('/org/un/birdeye/images/ui//Report.png')" width="100%" height="100%" >
			<report:Report width="100%" height="100%" />	
		</mx:Canvas>
		-->
		
		<mx:Canvas id="aboutCnvs" label="About..." icon="@Embed('/org/un/birdeye/images/ui//info.png')" width="100%" height="100%" >
			<about:About width="100%" height="100%" />
		</mx:Canvas>

	</flexlib:SuperTabNavigator>
	
</mx:VBox>


	
</mx:WindowedApplication>
