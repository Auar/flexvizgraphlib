<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:ui="org.un.birdeye.ui.*"
	xmlns:flexlib="http://code.google.com/p/flexlib/"
	creationComplete="init();" >    
	
	<mx:XML  
        id="myChart"  
        source="Chart.xml" 
        /> 
  
  
  	<mx:Script source="Dashboard.as" />
	<mx:Script><![CDATA[
	import org.un.birdeye.measure.view.Pod;
	import ilog.charts.AngularAxis;
	
	import flexlib.skins.SliderThumbHighlightSkin;
	import flexlib.controls.HSlider;
	import mx.controls.sliderClasses.Slider;
	
	import mx.charts.chartClasses.CartesianChart;	
	import mx.graphics.SolidColor;
	import mx.graphics.Stroke;
	import mx.controls.Alert;
	import mx.collections.*;
	import mx.charts.*;
	import mx.charts.series.*;
	import mx.charts.renderers.*;
	import mx.charts.events.*;
	import mx.controls.ColorPicker;
	import mx.events.ColorPickerEvent;
	import mx.controls.HRule;
	import mx.controls.ColorPicker;
	import mx.controls.Button;
	import mx.controls.CheckBox;
	import mx.controls.NumericStepper;
	import mx.charts.chartClasses.Series;
    import mx.charts.chartClasses.ChartBase;
    import mx.charts.events.ChartItemEvent;
    import mx.charts.ChartItem;
    
    // Pod
    import org.un.birdeye.measure.view.PodContentBase;
    import org.un.birdeye.measure.managers.PodLayoutManager;
    import org.un.birdeye.measure.events.LayoutChangeEvent;
    // ILOG
    import mx.graphics.SolidColor;
    import ilog.maps.MapBase;
    import ilog.maps.MapEvent;
    import ilog.maps.MapFeature;
    import ilog.maps.WorldCountriesMap;
    import ilog.maps.MapSymbol;
    import ilog.charts.RadarChart;
    import ilog.charts.series.RadarLineSeries;
    import ilog.charts.series.*;
    import ilog.treemap.TreeMap;
    import ilog.treemap.TreeMap;
	import ilog.maps.*
    // Symbols lib
    import com.flexibleexperiments.primitiveIcons.*;
    
    
    // Public vars
    public var myTreeData:XML = new XML();	
    public var myData:XML = new XML();		
	public var xmlData:XML = new XML();
	public var xmlDataModif:XML = new XML();
	public var arrAxis:Array = new Array();
	public var xField:String;
	public var yField:String;
	public var rField:String;
	public var highField:String;
	public var lowField:String;
	public var openField:String;
	public var closeField:String;
	public var labelField:String;
	public var weightField:String;
	public var colorField:String;
	public var dataField:String;
	public var CategoryxField:String;
	public var CategoryyField:String;
	public var f:SolidColor;
	public var s:Stroke;
	public var slicedResults:Array;
	public var dataList:XMLList;
	public var dataListCollection:XMLListCollection;
	public var dataSort:Sort;
	//public var numberOfSeries:int;
	public var numberOfSerie:Array=new Array();
	public var num:int=1;
	public var DisplayType:String;
	public var minxValue:int;
	public var maxxValue:int;
	public var minyValue:int;
	public var maxyValue:int;
	public var cnvs:Canvas;
	public var accordionIndex:int;
	public var HBoxMinMaxx:HBox;
	public var HBoxMinMaxy:HBox;
	public var arrPods:Array=new Array();
	public var firstPod:Pod = new Pod();
	//public var nextPod:Pod = new Pod();
	public var createNewPod:Boolean;
	public var arrNewPod:Array=new Array();
	public var numOfPiano:int;
	public var pianoNumber:int;
	
	public function ParseAxis(Axis:XML):void { 
		var AxisAttributes:XMLList = Axis.children().attributes(); 
		var i:int = 0;
		var n:String = "";
		for each (var axisElements:XML in AxisAttributes) { 
		n = axisElements.name();	
  		if (n.substr(0,4) != "nodeName") {
  			arrAxis[i]=n;
  			i++
			}
		} 
		arrAxis.sort();
		removeDup(arrAxis);		
	}
	
	public function LoadXML():void { 
		dataList=xmlData.children();
		dataListCollection=new XMLListCollection(dataList);
		ParseAxis(xmlData)
		
		 numberItems=xmlData.children().length();
				
		cnvs1_cbyAxis1.dataProvider=arrAxis;
		
		//crÃ©ation du 1er Pod
		firstPod.addEventListener(FlexEvent.UPDATE_COMPLETE, onCreationCompletePod);
		firstPod.id = "Pod1";
		addPod(firstPod, 1, firstPod.id);
		arrPods[1]=firstPod;
		arrNewPod[1]=false;
		refreshChart();
	} 
	

	private function removeDup(a:Array):void
	{
	        for(var y:int=0;y<a.length;y++){
	                for(var z:int=(y+1);z<=a.length;z++){
	                        if(a[y]==a[z]){
	                                a.splice(z,1)
	                                z--
	                        }
	                }
	        }
	}
	
	//Fonction d'initialisation au premier lancement de l'application
	private function init():void {
		myTreeData =  parentDocument.gTreeXML;
		xmlData = parentDocument.gDataXML;
		createPodManager();
		numberOfSerie[1]=1;
		LoadXML();
		
		
	}
	
	
	public function addDefaultChildToCnvs(pianoCnvs:Object,canvasNum:int):void{
		numberOfSerie[canvasNum]=1;
				
    	
				var lblChartType:Label=new Label();
				lblChartType.id="cnvs"+canvasNum+"_lblChartType";
				lblChartType.name="cnvs"+canvasNum+"_lblChartType";
				lblChartType.x=2;
				lblChartType.y=10;
				lblChartType.text="Chart type :"
				pianoCnvs.addChild(lblChartType);
		
				var cbChartType:ComboBox=new ComboBox();
				cbChartType.id="cnvs"+canvasNum+"_cbChartType";
				cbChartType.name="cnvs"+canvasNum+"_cbChartType";
				cbChartType.dataProvider=myChart.chart.@Type;
				cbChartType.addEventListener(Event.CHANGE, changeTypeEvt); 
				cbChartType.prompt="Select...";
				cbChartType.x=73;
				cbChartType.y=8;
				cbChartType.width=160;
				pianoCnvs.addChild(cbChartType);
				
				
				arrNewPod[canvasNum]=true;
				//refreshChart();
			}
			
	private function addSeries(event:Event):void{
		accordionIndex=leftAccordion.selectedIndex+1
		numberOfSerie[accordionIndex]=numberOfSerie[accordionIndex]+1;
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		var strChart:String=ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()
		if (myChart.chart.(@Type==strChart).Properties.Property.(@name=="barTypes").length() !=0){
	    	ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbDisplay")).alpha=1;
	    	ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbDisplay")).setStyle("color", 0x000000);
			Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblDisplay")).setStyle("color", 0x000000);
		}
		var myColor:uint = Math.round( Math.random()*0xFFFFFF );
		
		if(strChart=="Area" || strChart=="Bar" || strChart=="Column" || strChart=="Line" || strChart=="Plot"){
		
    		var sep:HRule=new HRule();
    		sep.id="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.name="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y;
    		sep.x=13;sep.width=210;
    		cnvs.addChild(sep);
    		
    		var lblSerieNum:Label=new Label();
    		lblSerieNum.id="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.name="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.text= "Serie " + numberOfSerie[accordionIndex] + " :";
    		lblSerieNum.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		lblSerieNum.x=3;
    		cnvs.addChild(lblSerieNum);
    		
    		var colPicker:ColorPicker=new ColorPicker();
    		colPicker.id="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.name="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		colPicker.x=60;
    		colPicker.width=17;
    		colPicker.height=17;
    		colPicker.selectedColor=myColor;//0x6699CC;
    		colPicker.addEventListener(Event.CHANGE, refreshChartEvent);
    		cnvs.addChild(colPicker);
    		
    		
    		var cbyAxis:ComboBox=new ComboBox();
    		cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbyAxis.dataProvider=arrAxis;
    		cbyAxis.prompt="Select...";
    		cbyAxis.x=85;
    		cbyAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+8;
    		cnvs.addChild(cbyAxis);
    		
				var chkRemove:CheckBox=new CheckBox();
    		chkRemove.id="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.name="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.x=200;
    		chkRemove.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+9;
    		chkRemove.addEventListener(MouseEvent.CLICK, removeSeriesEvent);
    		cnvs.addChild(chkRemove);
		
    		Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y+38);
				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+38);
		
		}else if(strChart=="Bubble"){
				var sep:HRule=new HRule();
    		sep.id="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.name="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y;
    		sep.x=13;sep.width=210;
    		cnvs.addChild(sep);
    		
    		var lblSerieNum:Label=new Label();
    		lblSerieNum.id="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.name="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.text= "Serie " + numberOfSerie[accordionIndex] + " :";
    		lblSerieNum.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		lblSerieNum.x=3;
    		cnvs.addChild(lblSerieNum);
    		
    		var colPicker:ColorPicker=new ColorPicker();
    		colPicker.id="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.name="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		colPicker.x=60;
    		colPicker.width=17;
    		colPicker.height=17;
    		colPicker.selectedColor=myColor;//0x6699CC;
    		colPicker.addEventListener(Event.CHANGE, refreshChartEvent);
    		cnvs.addChild(colPicker);
    		
    		var cbyAxis:ComboBox=new ComboBox();
    		cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbyAxis.dataProvider=arrAxis;
    		cbyAxis.prompt="Select...";
    		cbyAxis.x=85;
    		cbyAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+8;
    		cnvs.addChild(cbyAxis);
				
				var cbRadius:ComboBox=new ComboBox();
    		cbRadius.id="cnvs"+accordionIndex+"_cbRadius"+numberOfSerie[accordionIndex];
    		cbRadius.name="cnvs"+accordionIndex+"_cbRadius"+numberOfSerie[accordionIndex];
    		cbRadius.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbRadius.dataProvider=arrAxis;
    		cbRadius.prompt="Radius...";
    		cbRadius.x=85;
    		cbRadius.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+38;
    		cnvs.addChild(cbRadius);
				
				var chkRemove:CheckBox=new CheckBox();
    		chkRemove.id="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.name="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.x=200;
    		chkRemove.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+9;
    		chkRemove.addEventListener(MouseEvent.CLICK, removeSeriesEvent);
    		cnvs.addChild(chkRemove);
				
				Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y+68);
				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+68);
		}else if(strChart=="Candlestick" || strChart=="HighLowOpenClose" ){
				var sep:HRule=new HRule();
    		sep.id="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.name="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y;
    		sep.x=13;sep.width=210;
    		cnvs.addChild(sep);
    		
    		var lblSerieNum:Label=new Label();
    		lblSerieNum.id="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.name="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.text= "Serie " + numberOfSerie[accordionIndex] + " :";
    		lblSerieNum.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		lblSerieNum.x=3;
    		cnvs.addChild(lblSerieNum);
    		
    		var colPicker:ColorPicker=new ColorPicker();
    		colPicker.id="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.name="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		colPicker.x=60;
    		colPicker.width=17;
    		colPicker.height=17;
    		colPicker.selectedColor=myColor;//0x6699CC;
    		colPicker.addEventListener(Event.CHANGE, refreshChartEvent);
    		cnvs.addChild(colPicker);
    		
    		var cbyAxis:ComboBox=new ComboBox();
    		cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbyAxis.dataProvider=arrAxis;
    		cbyAxis.prompt="Low Field...";
    		cbyAxis.x=85;
    		cbyAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+8;
    		cnvs.addChild(cbyAxis);
				
				var cbxAxis:ComboBox=new ComboBox();
    		cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis"+numberOfSerie[accordionIndex];
    		cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis"+numberOfSerie[accordionIndex];
    		cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbxAxis.dataProvider=arrAxis;
    		cbxAxis.prompt="High Field...";
    		cbxAxis.x=85;
    		cbxAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+38;
    		cnvs.addChild(cbxAxis);
				
				var cbOpen:ComboBox=new ComboBox();
    		cbOpen.id="cnvs"+accordionIndex+"_cbOpenField"+numberOfSerie[accordionIndex];
    		cbOpen.name="cnvs"+accordionIndex+"_cbOpenField"+numberOfSerie[accordionIndex];
    		cbOpen.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbOpen.dataProvider=arrAxis;
    		cbOpen.prompt="Open Field...";
    		cbOpen.x=85;
    		cbOpen.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+68;
    		cnvs.addChild(cbOpen);
    		
    		var cbClose:ComboBox=new ComboBox();
    		cbClose.id="cnvs"+accordionIndex+"_cbCloseField"+numberOfSerie[accordionIndex];
    		cbClose.name="cnvs"+accordionIndex+"_cbCloseField"+numberOfSerie[accordionIndex];
    		cbClose.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbClose.dataProvider=arrAxis;
    		cbClose.prompt="Close Field...";
    		cbClose.x=85;
    		cbClose.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+98;
    		cnvs.addChild(cbClose);
				
				var chkRemove:CheckBox=new CheckBox();
    		chkRemove.id="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.name="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.x=200;
    		chkRemove.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+9;
    		chkRemove.addEventListener(MouseEvent.CLICK, removeSeriesEvent);
    		cnvs.addChild(chkRemove);
				
				Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y+128);
				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+128);
		}if(strChart=="Pie" ){
				var sep:HRule=new HRule();
    		sep.id="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.name="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y;
    		sep.x=13;sep.width=210;
    		cnvs.addChild(sep);
    		
    		var lblSerieNum:Label=new Label();
    		lblSerieNum.id="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.name="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.text= "Serie " + numberOfSerie[accordionIndex] + " :";
    		lblSerieNum.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		lblSerieNum.x=3;
    		cnvs.addChild(lblSerieNum);
    		
    		var cbyAxis:ComboBox=new ComboBox();
    		cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbyAxis.dataProvider=arrAxis;
    		cbyAxis.prompt="Select...";
    		cbyAxis.x=85;
    		cbyAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+8;
    		cnvs.addChild(cbyAxis);
				
				var chkRemove:CheckBox=new CheckBox();
    		chkRemove.id="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.name="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.x=200;
    		chkRemove.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+9;
    		chkRemove.addEventListener(MouseEvent.CLICK, removeSeriesEvent);
    		cnvs.addChild(chkRemove);
				
				Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y+38);
				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+38);
		
		}if(strChart=="Cartesian"){
				var sep:HRule=new HRule();
    		sep.id="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.name="cnvs"+accordionIndex+"_sep"+numberOfSerie[accordionIndex];
    		sep.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y;
    		sep.x=13;sep.width=210;
    		cnvs.addChild(sep);
    		
    		var lblSerieNum:Label=new Label();
    		lblSerieNum.id="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.name="cnvs"+accordionIndex+"_lblSerieNum"+numberOfSerie[accordionIndex];
    		lblSerieNum.text= "Serie " + numberOfSerie[accordionIndex] + " :";
    		lblSerieNum.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		lblSerieNum.x=3;
    		cnvs.addChild(lblSerieNum);
    		
    		var colPicker:ColorPicker=new ColorPicker();
    		colPicker.id="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.name="cnvs"+accordionIndex+"_cp"+numberOfSerie[accordionIndex];
    		colPicker.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+10;
    		colPicker.x=60;
    		colPicker.width=17;
    		colPicker.height=17;
    		colPicker.selectedColor=myColor;//0x6699CC;
    		colPicker.addEventListener(Event.CHANGE, refreshChartEvent);
    		cnvs.addChild(colPicker);
    		
				var cbCartSerie:ComboBox=new ComboBox();
    		cbCartSerie.id="cnvs"+accordionIndex+"_cbCartSerie"+numberOfSerie[accordionIndex];
    		cbCartSerie.name="cnvs"+accordionIndex+"_cbCartSerie"+numberOfSerie[accordionIndex];
    		cbCartSerie.addEventListener(Event.CHANGE, refreshCartChartEvent);
    		cbCartSerie.dataProvider=myChart.chart.(@Type=="Cartesian").Properties.Property.Series.Serie;
    		cbCartSerie.prompt="Select...";
    		cbCartSerie.x=85;
    		cbCartSerie.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+8;
    		cnvs.addChild(cbCartSerie);
				
    		var cbyAxis:ComboBox=new ComboBox();
    		cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis"+numberOfSerie[accordionIndex];
    		cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbyAxis.dataProvider=arrAxis;
    		cbyAxis.prompt="Low Field...";
    		cbyAxis.x=85;
    		cbyAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+38;
    		cnvs.addChild(cbyAxis);
				
				var cbxAxis:ComboBox=new ComboBox();
    		cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis"+numberOfSerie[accordionIndex];
    		cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis"+numberOfSerie[accordionIndex];
    		cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbxAxis.dataProvider=arrAxis;
    		cbxAxis.prompt="High Field...";
				cbxAxis.alpha=0.3;
				cbxAxis.setStyle("color", 0xCCCCCC);
    		cbxAxis.x=85;
    		cbxAxis.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+68;
    		cnvs.addChild(cbxAxis);
				
				var cbOpen:ComboBox=new ComboBox();
    		cbOpen.id="cnvs"+accordionIndex+"_cbOpenField"+numberOfSerie[accordionIndex];
    		cbOpen.name="cnvs"+accordionIndex+"_cbOpenField"+numberOfSerie[accordionIndex];
    		cbOpen.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbOpen.dataProvider=arrAxis;
    		cbOpen.prompt="Open Field...";
				cbOpen.alpha=0.3;
				cbOpen.setStyle("color", 0xCCCCCC);
    		cbOpen.x=85;
    		cbOpen.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+98;
    		cnvs.addChild(cbOpen);
    		
    		var cbClose:ComboBox=new ComboBox();
    		cbClose.id="cnvs"+accordionIndex+"_cbCloseField"+numberOfSerie[accordionIndex];
    		cbClose.name="cnvs"+accordionIndex+"_cbCloseField"+numberOfSerie[accordionIndex];
    		cbClose.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbClose.dataProvider=arrAxis;
    		cbClose.prompt="Close Field...";
				cbClose.alpha=0.3;
				cbClose.setStyle("color", 0xCCCCCC);
    		cbClose.x=85;
    		cbClose.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+128;
    		cnvs.addChild(cbClose);
				
				var cbRadius:ComboBox=new ComboBox();
    		cbRadius.id="cnvs"+accordionIndex+"_cbRadius"+numberOfSerie[accordionIndex];
    		cbRadius.name="cnvs"+accordionIndex+"_cbRadius"+numberOfSerie[accordionIndex];
    		cbRadius.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbRadius.dataProvider=arrAxis;
    		cbRadius.prompt="Radius...";
				cbRadius.alpha=0.3;
				cbRadius.setStyle("color", 0xCCCCCC);
    		cbRadius.x=85;
    		cbRadius.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+158;
    		cnvs.addChild(cbRadius);
				
				var cbCartForm:ComboBox=new ComboBox();
    		cbCartForm.id="cnvs"+accordionIndex+"_cbCartForm"+numberOfSerie[accordionIndex];
    		cbCartForm.name="cnvs"+accordionIndex+"_cbCartForm"+numberOfSerie[accordionIndex];
    		cbCartForm.addEventListener(Event.CHANGE, refreshChartEvent);
    		cbCartForm.dataProvider=myChart.chart.(@Type=="Cartesian").Properties.Property.cartForms.cartForm;
    		cbCartForm.prompt="Form...";
				cbCartForm.alpha=0.3;
				cbCartForm.setStyle("color", 0xCCCCCC);
    		cbCartForm.x=85;
    		cbCartForm.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+188;
    		cnvs.addChild(cbCartForm);
				
				var chkRemove:CheckBox=new CheckBox();
    		chkRemove.id="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.name="cnvs"+accordionIndex+"_chkRemove"+numberOfSerie[accordionIndex];
    		chkRemove.x=200;
    		chkRemove.y=HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+9;
    		chkRemove.addEventListener(MouseEvent.CLICK, removeSeriesEvent);
    		cnvs.addChild(chkRemove);
				
				Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y+218);
				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y+218);
		
		}
	}
	
	private function removeSeriesEvent(event:Event):void{
		accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		num=event.target.name.substr(15);
		var strChart:String=ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()
		
		if(strChart=="Area" || strChart=="Bar" || strChart=="Column" || strChart=="Line" || strChart=="Plot"){
					cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+num));
      		
      		for (var i:int=1; i<=numberOfSerie[accordionIndex]; i++) { 
      			if (i>num){
      				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).y-38);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).move(Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).x,Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).y-38);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).text="Serie " + (i-1) + " :";
      				ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).move(ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).x,ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).y-38);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).y-38);
      				CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).move(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).x,CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).y-38);
      				
      				cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i).name="cnvs"+accordionIndex+"_sep"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i).name="cnvs"+accordionIndex+"_lblSerieNum"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i).name="cnvs"+accordionIndex+"_cp"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i).name="cnvs"+accordionIndex+"_cbyAxis"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i).name="cnvs"+accordionIndex+"_chkRemove"+(i-1);
      			}
      		}
      		Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y-38);
      		HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y-38);
      		
		}else if(strChart=="Bubble"){
					cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num));
      		
      		for (var i:int=1; i<=numberOfSerie[accordionIndex]; i++) { 
      			if (i>num){
      				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).y-68);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).move(Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).x,Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).y-68);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).text="Serie " + (i-1) + " :";
      				ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).move(ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).x,ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).y-68);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).y-68);
      				CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).move(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).x,CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).y-68);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i)).y-68);
      				
      				cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i).name="cnvs"+accordionIndex+"_sep"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i).name="cnvs"+accordionIndex+"_lblSerieNum"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i).name="cnvs"+accordionIndex+"_cp"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i).name="cnvs"+accordionIndex+"_cbyAxis"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i).name="cnvs"+accordionIndex+"_chkRemove"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i).name="cnvs"+accordionIndex+"_cbRadius"+(i-1);
      			}
      		}
      		Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y-68);
      		HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y-68);
      		
		}else if(strChart=="Candlestick" || strChart=="HighLowOpenClose" ){
			cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num));
      		
      		for (var i:int=1; i<=numberOfSerie[accordionIndex]; i++) { 
      			if (i>num){
      				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).y-128);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).move(Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).x,Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).y-128);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).text="Serie " + (i-1) + " :";
      				ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).move(ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).x,ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).y-128);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).y-128);
      				CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).move(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).x,CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).y-128);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i)).y-128);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i)).y-128);
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i)).y-128);
      				
      				cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i).name="cnvs"+accordionIndex+"_sep"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i).name="cnvs"+accordionIndex+"_lblSerieNum"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i).name="cnvs"+accordionIndex+"_cp"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i).name="cnvs"+accordionIndex+"_cbyAxis"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i).name="cnvs"+accordionIndex+"_chkRemove"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i).name="cnvs"+accordionIndex+"_cbxAxis"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i).name="cnvs"+accordionIndex+"_cbOpenField"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i).name="cnvs"+accordionIndex+"_cbCloseField"+(i-1);
      			}
      		}
      		Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y-128);
      		HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y-128);
      		
		}else if(strChart=="Pie" ){
					cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num));
      		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+num));
      		
      		for (var i:int=1; i<=numberOfSerie[accordionIndex]; i++) { 
      			if (i>num){
      				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).y-38);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).move(Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).x,Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).y-38);
      				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).text="Serie " + (i-1) + " :";
      				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).y-38);
      				CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).move(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).x,CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).y-38);
      				
      				cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i).name="cnvs"+accordionIndex+"_sep"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i).name="cnvs"+accordionIndex+"_lblSerieNum"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i).name="cnvs"+accordionIndex+"_cbyAxis"+(i-1);
      				cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i).name="cnvs"+accordionIndex+"_chkRemove"+(i-1);
      			}
      		}
      		Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y-38);
      		HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y-38);
      		
		}else if(strChart=="Cartesian"){
		
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num));
    		cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num));
				cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num));
      	cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num));
      	cnvs.removeChild(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num));
					
    		for (var i:int=1; i<=numberOfSerie[accordionIndex]; i++) { 
    			if (i>num){
    				HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i)).y-218);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).move(Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).x,Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).y-218);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i)).text="Serie " + (i-1) + " :";
    				ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).move(ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).x,ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i)).y-218);
    				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i)).y-218);
    				CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).move(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).x,CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i)).y-218);
    				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+i)).y-218);
    				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+i)).y-218);
    				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i)).y-218);
      			ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i)).y-218);
      			ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i)).y-218);
      			ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i)).move(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i)).x,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i)).y-218);
      				
    				cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+i).name="cnvs"+accordionIndex+"_sep"+(i-1);
    				cnvs.getChildByName("cnvs"+accordionIndex+"_lblSerieNum"+i).name="cnvs"+accordionIndex+"_lblSerieNum"+(i-1);
    				cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+i).name="cnvs"+accordionIndex+"_cp"+(i-1);
    				cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+i).name="cnvs"+accordionIndex+"_cbyAxis"+(i-1);
    				cnvs.getChildByName("cnvs"+accordionIndex+"_chkRemove"+i).name="cnvs"+accordionIndex+"_chkRemove"+(i-1);
    				cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+i).name="cnvs"+accordionIndex+"_cbCartSerie"+(i-1);
    				cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+i).name="cnvs"+accordionIndex+"_cbCartForm"+(i-1);
						cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+i).name="cnvs"+accordionIndex+"_cbRadius"+(i-1);
						cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+i).name="cnvs"+accordionIndex+"_cbxAxis"+(i-1);
      			cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+i).name="cnvs"+accordionIndex+"_cbOpenField"+(i-1);
      			cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+i).name="cnvs"+accordionIndex+"_cbCloseField"+(i-1);
    			}
    		}
    		Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).move(Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).x,Button(cnvs.getChildByName("cnvs"+accordionIndex+"_btnAddNewSerie")).y-218);
    		HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).move(HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).x,HRule(cnvs.getChildByName("cnvs"+accordionIndex+"_hrEnd")).y-218);
		}
		numberOfSerie[accordionIndex]=numberOfSerie[accordionIndex]-1;
		
		if (myChart.chart.(@Type==ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()).Properties.Property.(@name=="barTypes").length() !=0){
	    	if(numberOfSerie[accordionIndex]==1){
				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblDisplay")).setStyle("color", 0xCCCCCC);
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbDisplay")).setStyle("color", 0xCCCCCC);
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbDisplay")).alpha=0.3;
		
			}
		}
		refreshChart();
	}	
	
    public function changeTypeEvt(event:Event):void {
		accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		var strChartType:String = event.target.selectedLabel.toString()
		var ChartTypeIndex:int=event.target.selectedIndex;
		cnvs.removeAllChildren();
		numberOfSerie[accordionIndex]=1;
		
		var lblChartType:Label=new Label();
		lblChartType.id="cnvs"+accordionIndex+"_lblChartType";
		lblChartType.name="cnvs"+accordionIndex+"_lblChartType";
		lblChartType.x=2;
		lblChartType.y=10;
		lblChartType.text="Chart type :"
		cnvs.addChild(lblChartType);

		var cbChartType:ComboBox=new ComboBox();
		cbChartType.id="cnvs"+accordionIndex+"_cbChartType";
		cbChartType.name="cnvs"+accordionIndex+"_cbChartType";
		cbChartType.dataProvider=myChart.chart.@Type;
		cbChartType.selectedIndex=ChartTypeIndex;
		cbChartType.addEventListener(Event.CHANGE, changeTypeEvt);
		cbChartType.x=73;
		cbChartType.y=8;
		cbChartType.width=160;
		cnvs.addChild(cbChartType);
		
		var lblForm:Label=new Label();
		var cbForm:ComboBox=new ComboBox();
		var lblDisplay:Label=new Label();
		var cbDisplay:ComboBox=new ComboBox();
		var hrChartType:HRule=new HRule();
		var chkDataType:CheckBox=new CheckBox();
		var chkLegend:CheckBox=new CheckBox();
		var chkGrid:CheckBox=new CheckBox();
		var hrSel:HRule=new HRule();
		var lblSerie:Label=new Label();
		var cp:ColorPicker=new ColorPicker();
		var lblxAxis:Label=new Label();
		var cbxAxis:ComboBox=new ComboBox();
		var lblyAxis:Label=new Label();
		var cbyAxis:ComboBox=new ComboBox();
		var lblxAxisType:Label=new Label();
		var cbxAxisType:ComboBox=new ComboBox();
		var lblxInterval1:Label=new Label();
		var txtxInterval:NumericStepper=new NumericStepper();
		var HBoxMinMaxx:HBox=new HBox();
		var lblxMin:Label=new Label();
		var minMaxxSlider:flexlib.controls.HSlider=new flexlib.controls.HSlider();
		var lblxMax:Label=new Label();
		var lblyAxisType:Label=new Label();
		var cbyAxisType:ComboBox=new ComboBox();
		var lblyInterval1:Label=new Label();
		var txtyInterval:NumericStepper=new NumericStepper();
		var HBoxMinMaxy:HBox=new HBox();
		var lblyMin:Label=new Label();
		var minMaxySlider:flexlib.controls.HSlider=new flexlib.controls.HSlider();
		var lblyMax:Label=new Label();
		var hrEnd:HRule=new HRule();
		var btnAddSerie:Button=new Button();
		var lblRadius:Label=new Label();
		var cbRadius:ComboBox=new ComboBox();
		var lblExplode:Label=new Label();
		var PieExplode:flexlib.controls.HSlider=new flexlib.controls.HSlider();
		var lblAngle:Label=new Label();
		var PieAngle:flexlib.controls.HSlider=new flexlib.controls.HSlider();
		var lblDonuts:Label=new Label();
		var PieDonuts:flexlib.controls.HSlider=new flexlib.controls.HSlider();
		var lblLabelPosition:Label=new Label();
		var cbLabelPosition:ComboBox=new ComboBox();
		var lblOpenField:Label=new Label();
		var cbOpenField:ComboBox=new ComboBox();
		var lblCloseField:Label=new Label();
		var cbCloseField:ComboBox=new ComboBox();
		var lblCartForm:Label=new Label();
		var cbCartForm:ComboBox=new ComboBox();
																						
				
		switch (strChartType) { 
		    case "Area" : 
		    
		    	lblForm.id="cnvs"+accordionIndex+"_lblForm";
				lblForm.name="cnvs"+accordionIndex+"_lblForm";
				lblForm.x=3;
				lblForm.y=36;
				lblForm.text="Form :"
				cnvs.addChild(lblForm);
				
				
				cbForm.id="cnvs"+accordionIndex+"_cbForm";
				cbForm.name="cnvs"+accordionIndex+"_cbForm";
				cbForm.dataProvider=myChart.chart[0].Properties.Property.Forms.Form;
				cbForm.addEventListener(Event.CHANGE, refreshChartEvent); 
				cbForm.x=73;
				cbForm.y=34;
				cbForm.width=160;
				cnvs.addChild(cbForm);
				
				lblDisplay.id="cnvs"+accordionIndex+"_lblDisplay";
				lblDisplay.name="cnvs"+accordionIndex+"_lblDisplay";
				lblDisplay.text= "Display :";
				lblDisplay.y=62;
				lblDisplay.x=3;
				cnvs.addChild(lblDisplay);
				
				cbDisplay.id="cnvs"+accordionIndex+"_cbDisplay";
				cbDisplay.name="cnvs"+accordionIndex+"_cbDisplay";
				cbDisplay.addEventListener(Event.CHANGE, refreshChartEvent);
				cbDisplay.dataProvider=myChart.chart[0].Properties.Property.barTypes.barType;
				cbDisplay.x=73;
				cbDisplay.y=60;
				cnvs.addChild(cbDisplay);
				
				hrChartType.x=13;
				hrChartType.y=89;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=95;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=117;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=139;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=161;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=165;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=166;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
		
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=188;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=186;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=282;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=280;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=214;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);

				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=213;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=244;
				lblxInterval1.x=150;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=242;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=260;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=309;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=307;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=336;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=334;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=357;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0,0];// maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=380;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=390;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
				break;
		    case "Bar" : 
		    	lblDisplay.id="cnvs"+accordionIndex+"_lblDisplay";
				lblDisplay.name="cnvs"+accordionIndex+"_lblDisplay";
				lblDisplay.text= "Display :";
				lblDisplay.y=36;
				lblDisplay.x=3;
				cnvs.addChild(lblDisplay);
				
				cbDisplay.id="cnvs"+accordionIndex+"_cbDisplay";
				cbDisplay.name="cnvs"+accordionIndex+"_cbDisplay";
				cbDisplay.addEventListener(Event.CHANGE, refreshChartEvent);
				cbDisplay.dataProvider=myChart.chart[0].Properties.Property.barTypes.barType;
				cbDisplay.x=73;
				cbDisplay.y=34;
				cnvs.addChild(cbDisplay);
				
				hrChartType.x=13;
				hrChartType.y=63;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=69;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=91;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=113;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=135;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=139;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=140;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
		
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=162;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=160;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=256;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=254;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=188;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=187;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=218;
				lblxInterval1.x=150;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=216;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=234;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=283;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=280;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=310;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=308;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=331;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=354;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=364;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
				break; 
		    case "Bubble" : 
		    	hrChartType.x=13;
				hrChartType.y=36;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=42;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=64;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=86;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=108;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=112;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=113;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
		
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=138;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent); 
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=136;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=229;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=227;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=161;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=160;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=191;
				lblxInterval1.x=123;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=189;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=207;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=256;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=253;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=283;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=281;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=304;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				lblRadius.id="cnvs"+accordionIndex+"_lblRadius1";
				lblRadius.name="cnvs"+accordionIndex+"_lblRadius1";
				lblRadius.text= "Radius :";
				lblRadius.y=329;
				lblRadius.x=3;
				cnvs.addChild(lblRadius);
				
				cbRadius.id="cnvs"+accordionIndex+"_cbRadius1";
				cbRadius.name="cnvs"+accordionIndex+"_cbRadius1";
				cbRadius.addEventListener(Event.CHANGE, refreshChartEvent);
				cbRadius.dataProvider=arrAxis;
				cbRadius.prompt="Select...";
				cbRadius.x=73;
				cbRadius.y=327;
				cnvs.addChild(cbRadius);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=352;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=362;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
		        break; 
		    case "Candlestick" : 
		    	hrChartType.x=13;
				hrChartType.y=36;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=112;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=135;
				lblxAxis.text="High :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.prompt="Select...";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent); //parentDocument.
				cbxAxis.x=73;
				cbxAxis.y=133;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=217;
				lblyAxis.text="Low :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.prompt="Select...";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent); //parentDocument.
				cbyAxis.x=73;
				cbyAxis.y=215;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=161;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=160;
				cnvs.addChild(cbxAxisType);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=244;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=242;
				cnvs.addChild(cbyAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.setStyle("color", 0xCCCCCC);
				lblxInterval1.y=179;
				lblxInterval1.x=150;
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.x=197;
				txtxInterval.y=177;
				txtxInterval.width=36;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=195;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.setStyle("color", 0xCCCCCC);
				lblxMin.text= "min";
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.setStyle("color", 0xCCCCCC);
				lblxMax.text= "max";
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.setStyle("color", 0xCCCCCC);
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=273;
				lblyInterval1.x=150;
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.x=197;
				txtyInterval.y=271;
				txtyInterval.width=36;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=292;
				HBoxMinMaxy.percentWidth=100
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.setStyle("color", 0xCCCCCC);
				lblyMin.text= "min";
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.setStyle("color", 0xCCCCCC);
				lblyMax.text= "max";
				HBoxMinMaxy.addChild(lblyMax);
				
				hrSel.x=13;
				hrSel.y=108;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				chkDataType.x=10;
				chkDataType.y=42;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=64;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=86;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=113;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
				
		    	lblOpenField.id="cnvs"+accordionIndex+"_lblOpenField1";
				lblOpenField.name="cnvs"+accordionIndex+"_lblOpenField1";
				lblOpenField.text= "Open :";
				lblOpenField.y=322;
				lblOpenField.x=3;
				lblOpenField.width=55;
				cnvs.addChild(lblOpenField);
				
				cbOpenField.id="cnvs"+accordionIndex+"_cbOpenField1";
				cbOpenField.name="cnvs"+accordionIndex+"_cbOpenField1";
				cbOpenField.addEventListener(Event.CHANGE, refreshChartEvent);
				cbOpenField.prompt="Select...";
				cbOpenField.dataProvider=arrAxis;
				cbOpenField.x=73;
				cbOpenField.y=320;
				cnvs.addChild(cbOpenField);
				
				lblCloseField.id="cnvs"+accordionIndex+"_lblCloseField1";
				lblCloseField.name="cnvs"+accordionIndex+"_lblCloseField1";
				lblCloseField.text= "Close :";
				lblCloseField.y=345;
				lblCloseField.x=3;
				lblCloseField.width=55;
				cnvs.addChild(lblCloseField);
				
				cbCloseField.id="cnvs"+accordionIndex+"_cbCloseField1";
				cbCloseField.name="cnvs"+accordionIndex+"_cbCloseField1";
				cbCloseField.addEventListener(Event.CHANGE, refreshChartEvent);
				cbCloseField.dataProvider=arrAxis;
				cbCloseField.prompt="Select...";
				cbCloseField.x=73;
				cbCloseField.y=343;
				cnvs.addChild(cbCloseField)
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=370;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=380;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
		        break; 
		    case "Column" : 
		        lblDisplay.id="cnvs"+accordionIndex+"_lblDisplay";
				lblDisplay.name="cnvs"+accordionIndex+"_lblDisplay";
				lblDisplay.text= "Display :";
				lblDisplay.y=36;
				lblDisplay.x=3;
				cnvs.addChild(lblDisplay);
				
				cbDisplay.id="cnvs"+accordionIndex+"_cbDisplay";
				cbDisplay.name="cnvs"+accordionIndex+"_cbDisplay";
				cbDisplay.addEventListener(Event.CHANGE, refreshChartEvent);
				cbDisplay.dataProvider=myChart.chart[0].Properties.Property.barTypes.barType;
				cbDisplay.x=73;
				cbDisplay.y=34;
				cnvs.addChild(cbDisplay);
				
				hrChartType.x=13;
				hrChartType.y=63;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=69;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=91;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=113;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=135;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=139;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=140;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
		
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=162;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent); 
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=160;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=256;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=254;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=188;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=187;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=218;
				lblxInterval1.x=150;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=216;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=234;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=283;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=280;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=310;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=308;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=331;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=354;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=364;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
				break; 
		    case "HighLowOpenClose" : 
		    	hrChartType.x=13;
				hrChartType.y=36;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=112;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=135;
				lblxAxis.text="High :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.prompt="Select...";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent); //parentDocument.
				cbxAxis.x=73;
				cbxAxis.y=133;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=217;
				lblyAxis.text="Low :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.prompt="Select...";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent); //parentDocument.
				cbyAxis.x=73;
				cbyAxis.y=215;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=161;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=160;
				cnvs.addChild(cbxAxisType);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=244;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=242;
				cnvs.addChild(cbyAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.setStyle("color", 0xCCCCCC);
				lblxInterval1.y=179;
				lblxInterval1.x=150;
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.x=197;
				txtxInterval.y=177;
				txtxInterval.width=36;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=195;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.setStyle("color", 0xCCCCCC);
				lblxMin.text= "min";
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.setStyle("color", 0xCCCCCC);
				lblxMax.text= "max";
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.setStyle("color", 0xCCCCCC);
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=273;
				lblyInterval1.x=150;
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.x=197;
				txtyInterval.y=271;
				txtyInterval.width=36;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=292;
				HBoxMinMaxy.percentWidth=100
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.setStyle("color", 0xCCCCCC);
				lblyMin.text= "min";
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.setStyle("color", 0xCCCCCC);
				lblyMax.text= "max";
				HBoxMinMaxy.addChild(lblyMax);
				
				hrSel.x=13;
				hrSel.y=108;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				chkDataType.x=10;
				chkDataType.y=42;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=64;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=86;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=113;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
				
		    	lblOpenField.id="cnvs"+accordionIndex+"_lblOpenField1";
				lblOpenField.name="cnvs"+accordionIndex+"_lblOpenField1";
				lblOpenField.text= "Open :";
				lblOpenField.y=322;
				lblOpenField.x=3;
				lblOpenField.width=55;
				cnvs.addChild(lblOpenField);
				
				cbOpenField.id="cnvs"+accordionIndex+"_cbOpenField1";
				cbOpenField.name="cnvs"+accordionIndex+"_cbOpenField1";
				cbOpenField.addEventListener(Event.CHANGE, refreshChartEvent);
				cbOpenField.prompt="Select...";
				cbOpenField.dataProvider=arrAxis;
				cbOpenField.x=73;
				cbOpenField.y=320;
				cnvs.addChild(cbOpenField);
				
				lblCloseField.id="cnvs"+accordionIndex+"_lblCloseField1";
				lblCloseField.name="cnvs"+accordionIndex+"_lblCloseField1";
				lblCloseField.text= "Close :";
				lblCloseField.y=345;
				lblCloseField.x=3;
				lblCloseField.width=55;
				cnvs.addChild(lblCloseField);
				
				cbCloseField.id="cnvs"+accordionIndex+"_cbCloseField1";
				cbCloseField.name="cnvs"+accordionIndex+"_cbCloseField1";
				cbCloseField.addEventListener(Event.CHANGE, refreshChartEvent);
				cbCloseField.dataProvider=arrAxis;
				cbCloseField.prompt="Select...";
				cbCloseField.x=73;
				cbCloseField.y=343;
				cnvs.addChild(cbCloseField)
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=370;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=380;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
		        break; 
		    case "Line" : 
		    	lblForm.id="cnvs"+accordionIndex+"_lblForm";
				lblForm.name="cnvs"+accordionIndex+"_lblForm";
				lblForm.x=3;
				lblForm.y=36;
				lblForm.text="Form :"
				cnvs.addChild(lblForm);
				
				
				cbForm.id="cnvs"+accordionIndex+"_cbForm";
				cbForm.name="cnvs"+accordionIndex+"_cbForm";
				cbForm.dataProvider=myChart.chart[0].Properties.Property.Forms.Form;
				cbForm.addEventListener(Event.CHANGE, refreshChartEvent); 
				cbForm.x=73;
				cbForm.y=34;
				cbForm.width=160;
				cnvs.addChild(cbForm);
				
				hrChartType.x=13;
				hrChartType.y=63;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=69;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=91;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=113;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=135;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=139;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=140;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
		
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=162;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=160;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=256;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=254;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=188;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=187;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=219;
				lblxInterval1.x=150;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=216;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=234;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=283;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=280;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=310;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=308;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=331;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=354;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=364;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
				break; 
		    case "Pie" : 
		    	hrChartType.x=13;
				hrChartType.y=36;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=45;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=67;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
		    	hrSel.x=13;
				hrSel.y=89;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=93;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=115;
				lblyAxis.text="Field :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=115;
				cnvs.addChild(cbyAxis);
				
		    	lblExplode.id="cnvs"+accordionIndex+"_lblExplode";
				lblExplode.name="cnvs"+accordionIndex+"_lblExplode";
				lblExplode.text= "Distance of Separation";
				lblExplode.x=3;
				lblExplode.y=147;
				lblExplode.setStyle("fontSize",9);
				lblExplode.setStyle("textAlign","center");
				lblExplode.percentWidth=100;
				cnvs.addChild(lblExplode);
				
				PieExplode.id="cnvs"+accordionIndex+"_PieExplode";
				PieExplode.name="cnvs"+accordionIndex+"_PieExplode";
				PieExplode.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				PieExplode.allowTrackClick=true;
				PieExplode.allowThumbOverlap=true;
				PieExplode.liveDragging=true;
				PieExplode.showDataTip=true;
				PieExplode.setStyle("dataTipPlacement","bottom");
				PieExplode.setStyle("dataTipOffset",3);
				PieExplode.setStyle("showTrackHighlight",true);
				PieExplode.thumbCount=1;
				PieExplode.percentWidth=100;
				PieExplode.addEventListener(Event.CHANGE, refreshChartEvent);
				PieExplode.snapInterval=.01;
				PieExplode.minimum=0;
				PieExplode.maximum=1;
				PieExplode.values=[0];
				PieExplode.x=3;
				PieExplode.y=155;
				cnvs.addChild(PieExplode);
				
				lblAngle.id="cnvs"+accordionIndex+"_lblAngle";
				lblAngle.name="cnvs"+accordionIndex+"_lblAngle";
				lblAngle.text= "Angle of rotation";
				lblAngle.x=3;
				lblAngle.y=175;
				lblAngle.setStyle("fontSize",9);
				lblAngle.setStyle("textAlign","center");
				lblAngle.percentWidth=100;
				cnvs.addChild(lblAngle);
				
				PieAngle.id="cnvs"+accordionIndex+"_PieAngle";
				PieAngle.name="cnvs"+accordionIndex+"_PieAngle";
				PieAngle.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				PieAngle.allowTrackClick=true;
				PieAngle.allowThumbOverlap=true;
				PieAngle.liveDragging=true;
				PieAngle.showDataTip=true;
				PieAngle.setStyle("dataTipPlacement","bottom");
				PieAngle.setStyle("dataTipOffset",3);
				PieAngle.setStyle("showTrackHighlight",true);
				PieAngle.thumbCount=1;
				PieAngle.percentWidth=100;
				PieAngle.addEventListener(Event.CHANGE, refreshChartEvent);
				PieAngle.snapInterval=1;
				PieAngle.minimum=0;
				PieAngle.maximum=360;
				PieAngle.values=[0];
				PieAngle.x=3;
				PieAngle.y=183;
				PieAngle.dataTipFormatFunction=degrees_func
				cnvs.addChild(PieAngle);
				
				lblDonuts.id="cnvs"+accordionIndex+"_lblDonuts";
				lblDonuts.name="cnvs"+accordionIndex+"_lblDonuts";
				lblDonuts.text= "Donuts";
				lblDonuts.x=3;
				lblDonuts.y=203;
				lblDonuts.setStyle("fontSize",9);
				lblDonuts.setStyle("textAlign","center");
				lblDonuts.percentWidth=100;
				cnvs.addChild(lblDonuts);
				
				PieDonuts.id="cnvs"+accordionIndex+"_PieDonuts";
				PieDonuts.name="cnvs"+accordionIndex+"_PieDonuts";
				PieDonuts.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				PieDonuts.allowTrackClick=true;
				PieDonuts.allowThumbOverlap=true;
				PieDonuts.liveDragging=true;
				PieDonuts.showDataTip=true;
				PieDonuts.setStyle("dataTipPlacement","bottom");
				PieDonuts.setStyle("dataTipOffset",3);
				PieDonuts.setStyle("showTrackHighlight",true);
				PieDonuts.thumbCount=1;
				PieDonuts.percentWidth=100;
				PieDonuts.addEventListener(Event.CHANGE, refreshChartEvent);
				PieDonuts.snapInterval=0.01;
				PieDonuts.minimum=0;
				PieDonuts.maximum=1;
				PieDonuts.values=[0];
				PieDonuts.x=3;
				PieDonuts.y=211;
				cnvs.addChild(PieDonuts);
				
				lblLabelPosition.id="cnvs"+accordionIndex+"_lblLabelPosition";
				lblLabelPosition.name="cnvs"+accordionIndex+"_lblLabelPosition";
				lblLabelPosition.text= "Label Position :";
				lblLabelPosition.y=239;
				lblLabelPosition.x=3;
				cnvs.addChild(lblLabelPosition);
				
				cbLabelPosition.id="cnvs"+accordionIndex+"_cbLabelPosition";
				cbLabelPosition.name="cnvs"+accordionIndex+"_cbLabelPosition";
				cbLabelPosition.addEventListener(Event.CHANGE, refreshChartEvent);
				cbLabelPosition.dataProvider=myChart.chart.(@Type=="Pie").Properties.Property.labelPosition.value;
				cbLabelPosition.x=95;
				cbLabelPosition.y=239;
				cnvs.addChild(cbLabelPosition);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=273;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=283;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
		        break; 
		    case "Plot" : 
		    	hrChartType.x=13;
				hrChartType.y=36;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=42;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=64;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=86;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=108;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=112;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=113;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
		
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=138;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=136;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=229;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=227;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=161;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=160;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=191;
				lblxInterval1.x=123;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=189;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=207;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=256;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=253;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=283;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=281;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=304;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=329;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=339;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
		        break;
		    case "Radar" : 
		        break;
		    case "TreeMap" : 
		        break;
		    case "GeoMap" : 
		        break; 
		   case "Cartesian" : 
		   		hrChartType.x=13;
				hrChartType.y=36;
				hrChartType.width=210;
				cnvs.addChild(hrChartType);
				
				chkDataType.x=10;
				chkDataType.y=42;
				chkDataType.label="Show DataTips";
				chkDataType.id="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.name="cnvs"+accordionIndex+"_chkDataType";
				chkDataType.enabled=true;
				chkDataType.selected=true;
				chkDataType.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkDataType);
				
				chkLegend.x=10;
				chkLegend.y=64;
				chkLegend.label="Show Legend";
				chkLegend.id="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.name="cnvs"+accordionIndex+"_chkLegend";
				chkLegend.enabled=true;
				chkLegend.selected=true;
				chkLegend.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkLegend);
				
				chkGrid.x=10;
				chkGrid.y=86;
				chkGrid.label="Show Grid";
				chkGrid.id="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.name="cnvs"+accordionIndex+"_chkGrid";
				chkGrid.enabled=true;
				chkGrid.selected=false;
				chkGrid.addEventListener(MouseEvent.CLICK, refreshChartEvent);
				cnvs.addChild(chkGrid);
				
				hrSel.x=13;
				hrSel.y=108;
				hrSel.width=210;
				hrSel.height=1;
				cnvs.addChild(hrSel);
				
				lblSerie.id="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.name="cnvs"+accordionIndex+"_lblSelectData";
				lblSerie.x=3;
				lblSerie.y=112;
				lblSerie.width=139;
				lblSerie.text="Serie 1 :";
				cnvs.addChild(lblSerie);
				
				cp.id="cnvs"+accordionIndex+"_cp1";
				cp.name="cnvs"+accordionIndex+"_cp1";
				cp.y=113;
				cp.x=53;
				cp.width=17;
				cp.height=17;
				cp.selectedColor=0x6699CC;
				cp.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(cp);
				
				var cbCartSerie:ComboBox=new ComboBox();
				cbCartSerie.id="cnvs"+accordionIndex+"_cbCartSerie1";
				cbCartSerie.name="cnvs"+accordionIndex+"_cbCartSerie1";
				cbCartSerie.addEventListener(Event.CHANGE, refreshCartChartEvent);
				cbCartSerie.dataProvider=myChart.chart.(@Type=="Cartesian").Properties.Property.Series.Serie;
				cbCartSerie.prompt="Select...";
				cbCartSerie.x=73;
				cbCartSerie.y=113;
				cnvs.addChild(cbCartSerie);
				
				lblxAxis.id="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.name="cnvs"+accordionIndex+"_lblxAxis1";
				lblxAxis.x=3;
				lblxAxis.y=138;
				lblxAxis.text="xAxis :";
				cnvs.addChild(lblxAxis);
				
				cbxAxis.id="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.name="cnvs"+accordionIndex+"_cbxAxis1";
				cbxAxis.dataProvider=arrAxis;
				cbxAxis.addEventListener(Event.CHANGE, refreshChartEvent); 
				cbxAxis.prompt="Select...";
				cbxAxis.x=73;
				cbxAxis.y=136;
				cnvs.addChild(cbxAxis);
				
				lblyAxis.id="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.name="cnvs"+accordionIndex+"_lblyAxis1";
				lblyAxis.x=3;
				lblyAxis.y=229;
				lblyAxis.text="yAxis :";
				cnvs.addChild(lblyAxis);
				
				cbyAxis.id="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.name="cnvs"+accordionIndex+"_cbyAxis1";
				cbyAxis.dataProvider=arrAxis;
				cbyAxis.addEventListener(Event.CHANGE, refreshChartEvent);
				cbyAxis.prompt="Select...";
				cbyAxis.x=73;
				cbyAxis.y=227;
				cnvs.addChild(cbyAxis);
				
				lblxAxisType.id="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.name="cnvs"+accordionIndex+"_lblxAxisType1";
				lblxAxisType.x=3;
				lblxAxisType.y=161;
				lblxAxisType.text="xAxisType :";
				cnvs.addChild(lblxAxisType);
				
				cbxAxisType.id="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.name="cnvs"+accordionIndex+"_cbxAxisType1";
				cbxAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbxAxisType.addEventListener(Event.CHANGE, xAxisTypeChange); //parentDocument.
				cbxAxisType.x=73;
				cbxAxisType.y=160;
				cnvs.addChild(cbxAxisType);
				
				lblxInterval1.id="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.name="cnvs"+accordionIndex+"_lblxInterval1";
				lblxInterval1.text= "Interval :";
				lblxInterval1.y=191;
				lblxInterval1.x=123;
				lblxInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblxInterval1);
				
				txtxInterval.id="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.name="cnvs"+accordionIndex+"_txtxInterval1";
				txtxInterval.x=197;
				txtxInterval.y=189;
				txtxInterval.width=36;
				txtxInterval.setStyle("color", 0xCCCCCC);
				txtxInterval.alpha=0.3;
				txtxInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtxInterval);
				
				HBoxMinMaxx.id="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.name="cnvs"+accordionIndex+"_HBoxMinMaxx";
				HBoxMinMaxx.x=4;
				HBoxMinMaxx.y=207;
				HBoxMinMaxx.percentWidth=100
				cnvs.addChild(HBoxMinMaxx);
				
				lblxMin.id="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.name="cnvs"+accordionIndex+"_lblxMin1";
				lblxMin.text= "min";
				lblxMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMin);
				
				minMaxxSlider.id="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.name="cnvs"+accordionIndex+"_minMaxxSlider";
				minMaxxSlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxxSlider.allowTrackClick=true;
				minMaxxSlider.allowThumbOverlap=true;
				minMaxxSlider.liveDragging=true;
				minMaxxSlider.showDataTip=true;
				minMaxxSlider.setStyle("dataTipPlacement","bottom");
				minMaxxSlider.setStyle("dataTipOffset",3);
				minMaxxSlider.setStyle("showTrackHighlight",true);
				minMaxxSlider.thumbCount=2;
				minMaxxSlider.percentWidth=100;
				minMaxxSlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxxSlider.snapInterval=0.1;
				minMaxxSlider.setStyle("color", 0xCCCCCC);
				minMaxxSlider.alpha=0.3;
				//minMaxxSlider.maximum=maxxSlideValue;
				minMaxxSlider.values=[0, 0];//maxxSlideDefault
				HBoxMinMaxx.addChild(minMaxxSlider);
				
				lblxMax.id="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.name="cnvs"+accordionIndex+"_lblxMax1";
				lblxMax.text= "max";
				lblxMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxx.addChild(lblxMax);
				
				lblyAxisType.id="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.name="cnvs"+accordionIndex+"_lblyAxisType1";
				lblyAxisType.x=3;
				lblyAxisType.y=256;
				lblyAxisType.text="yAxisType :";
				cnvs.addChild(lblyAxisType);
				
				cbyAxisType.id="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.name="cnvs"+accordionIndex+"_cbyAxisType1";
				cbyAxisType.dataProvider=myChart.chart[0].Properties.Property.axis;
				cbyAxisType.addEventListener(Event.CHANGE, yAxisTypeChange); //parentDocument.
				cbyAxisType.x=73;
				cbyAxisType.y=253;
				cnvs.addChild(cbyAxisType);
				
				lblyInterval1.id="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.name="cnvs"+accordionIndex+"_lblyInterval1";
				lblyInterval1.text= "Interval :";
				lblyInterval1.y=283;
				lblyInterval1.x=150;
				lblyInterval1.setStyle("color", 0xCCCCCC);
				cnvs.addChild(lblyInterval1);
				
				txtyInterval.id="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.name="cnvs"+accordionIndex+"_txtyInterval1";
				txtyInterval.x=197;
				txtyInterval.y=281;
				txtyInterval.width=36;
				txtyInterval.setStyle("color", 0xCCCCCC);
				txtyInterval.alpha=0.3;
				txtyInterval.addEventListener(Event.CHANGE, refreshChartEvent);
				cnvs.addChild(txtyInterval);
				
				HBoxMinMaxy.id="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.name="cnvs"+accordionIndex+"_HBoxMinMaxy";
				HBoxMinMaxy.x=4;
				HBoxMinMaxy.y=304;
				HBoxMinMaxy.percentWidth=100;
				cnvs.addChild(HBoxMinMaxy);
				
				lblyMin.id="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.name="cnvs"+accordionIndex+"_lblyMin1";
				lblyMin.text= "min";
				lblyMin.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMin);
				
				minMaxySlider.id="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.name="cnvs"+accordionIndex+"_minMaxySlider";
				minMaxySlider.setStyle("trackHighlightSkin",flexlib.skins.SliderThumbHighlightSkin);
				minMaxySlider.allowTrackClick=true;
				minMaxySlider.allowThumbOverlap=true;
				minMaxySlider.liveDragging=true;
				minMaxySlider.showDataTip=true;
				minMaxySlider.setStyle("dataTipPlacement","bottom");
				minMaxySlider.setStyle("dataTipOffset",3);
				minMaxySlider.setStyle("showTrackHighlight",true);
				minMaxySlider.thumbCount=2;
				minMaxySlider.percentWidth=100;
				minMaxySlider.addEventListener(Event.CHANGE, refreshChartEvent);
				minMaxySlider.snapInterval=0.1;
				minMaxySlider.setStyle("color", 0xCCCCCC);
				minMaxySlider.alpha=0.3;
				//minMaxySlider.minimum=0;
				//minMaxySlider.maximum=maxySlideValue;
				minMaxySlider.values=[0, 0];//maxySlideDefault
				HBoxMinMaxy.addChild(minMaxySlider);
				
				lblyMax.id="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.name="cnvs"+accordionIndex+"_lblyMax1";
				lblyMax.text= "max";
				lblyMax.setStyle("color", 0xCCCCCC);
				HBoxMinMaxy.addChild(lblyMax);
				
				lblRadius.id="cnvs"+accordionIndex+"_lblRadius1";
				lblRadius.name="cnvs"+accordionIndex+"_lblRadius1";
				lblRadius.text= "Radius :";
				lblRadius.setStyle("color", 0xCCCCCC);
				lblRadius.y=329;
				lblRadius.x=3;
				cnvs.addChild(lblRadius);
				
				cbRadius.id="cnvs"+accordionIndex+"_cbRadius1";
				cbRadius.name="cnvs"+accordionIndex+"_cbRadius1";
				cbRadius.addEventListener(Event.CHANGE, refreshChartEvent);
				cbRadius.dataProvider=arrAxis;
				cbRadius.alpha=0.3;
				cbRadius.setStyle("color", 0xCCCCCC);
				cbRadius.x=73;
				cbRadius.y=327;
				cnvs.addChild(cbRadius);
				
				lblOpenField.id="cnvs"+accordionIndex+"_lblOpenField1";
				lblOpenField.name="cnvs"+accordionIndex+"_lblOpenField1";
				lblOpenField.text= "Open :";
				lblOpenField.setStyle("color", 0xCCCCCC);
				lblOpenField.y=352;
				lblOpenField.x=3;
				lblOpenField.width=55;
				cnvs.addChild(lblOpenField);
				
				cbOpenField.id="cnvs"+accordionIndex+"_cbOpenField1";
				cbOpenField.name="cnvs"+accordionIndex+"_cbOpenField1";
				cbOpenField.addEventListener(Event.CHANGE, refreshChartEvent);
				cbOpenField.prompt="Select...";
				cbOpenField.alpha=0.3;
				cbOpenField.setStyle("color", 0xCCCCCC);
				cbOpenField.dataProvider=arrAxis;
				cbOpenField.x=73;
				cbOpenField.y=350;
				cnvs.addChild(cbOpenField);
				
				lblCloseField.id="cnvs"+accordionIndex+"_lblCloseField1";
				lblCloseField.name="cnvs"+accordionIndex+"_lblCloseField1";
				lblCloseField.text= "Close :";
				lblCloseField.setStyle("color", 0xCCCCCC);
				lblCloseField.y=375;
				lblCloseField.x=3;
				lblCloseField.width=55;
				cnvs.addChild(lblCloseField);
				
				cbCloseField.id="cnvs"+accordionIndex+"_cbCloseField1";
				cbCloseField.name="cnvs"+accordionIndex+"_cbCloseField1";
				cbCloseField.addEventListener(Event.CHANGE, refreshChartEvent);
				cbCloseField.dataProvider=arrAxis;
				cbCloseField.prompt="Select...";
				cbCloseField.alpha=0.3;
				cbCloseField.setStyle("color", 0xCCCCCC);
				cbCloseField.x=73;
				cbCloseField.y=373;
				cnvs.addChild(cbCloseField);
				
				lblCartForm.id="cnvs"+accordionIndex+"_lblCatForm1";
				lblCartForm.name="cnvs"+accordionIndex+"_lblCatForm1";
				lblCartForm.text= "Form :";
				lblCartForm.setStyle("color", 0xCCCCCC);
				lblCartForm.y=398;
				lblCartForm.x=3;
				cnvs.addChild(lblCartForm);
				
				cbCartForm.id="cnvs"+accordionIndex+"_cbCartForm1";
				cbCartForm.name="cnvs"+accordionIndex+"_cbCartForm1";
				cbCartForm.addEventListener(Event.CHANGE, refreshChartEvent);
				cbCartForm.dataProvider=myChart.chart.(@Type=="Cartesian").Properties.Property.cartForms.cartForm;
				cbCartForm.alpha=0.3;
				cbCartForm.setStyle("color", 0xCCCCCC);
				cbCartForm.x=73;
				cbCartForm.y=396;
				cnvs.addChild(cbCartForm);
				
				hrEnd.name="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.id="cnvs"+accordionIndex+"_hrEnd";
				hrEnd.x=10;
				hrEnd.y=425;
				hrEnd.width=210;
				cnvs.addChild(hrEnd);
				
				btnAddSerie.id="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.name="cnvs"+accordionIndex+"_btnAddNewSerie";
				btnAddSerie.x=73;
				btnAddSerie.y=435;
				btnAddSerie.label="Add new serie";
				btnAddSerie.addEventListener(MouseEvent.CLICK, addSeries);
				cnvs.addChild(btnAddSerie);
		        break; 
		}
		drawChart(strChartType);
    }
    
	
	public function FindMinMax(axe:String,status:String):void { 
		accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		HBoxMinMaxx=HBox(cnvs.getChildByName("cnvs"+accordionIndex+"_HBoxMinMaxx"))
		HBoxMinMaxy=HBox(cnvs.getChildByName("cnvs"+accordionIndex+"_HBoxMinMaxy"))
		var AxisAttributes:XMLList = xmlData.children().attributes()
		var arrValues:Array = new Array();
		
		//Alert.show(AxisAttributes.toXMLString(), 'Alert Box',mx.controls.Alert.OK);
		var i:int = 0;
		var n:String = "";
		var serieField:String
		for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
			if(axe=="x"){
				serieField=ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis1")).selectedLabel.toString();
			}else{
    			serieField=ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			}
			for each (var axisElements:XML in AxisAttributes) { 
			
				n = axisElements.name();	
		  		if (n == serieField) {
		  			arrValues[i]=int(axisElements.toXMLString());
		  			i++
				}
			} 
		}
		
		arrValues.sort(Array.NUMERIC);
		
		if(axe=="x"){
			minxValue=arrValues[0];
			maxxValue=arrValues[arrValues.length-1];
			maxxSlideValue=int(arrValues[arrValues.length-1])//*numberOfSerie[accordionIndex];
			maxxSlideDefault=int(arrValues[arrValues.length-1]);	
			flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).minimum=minxValue;
			flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).maximum=maxxValue;
			if(status=="Init"){
				flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).values=[minxValue, maxxValue];
			}
		}else{
			minyValue=arrValues[0];
			maxyValue=arrValues[arrValues.length-1];
			maxySlideValue=int(arrValues[arrValues.length-1])*2//*numberOfSerie[accordionIndex];
			maxySlideDefault=int(arrValues[arrValues.length-1]);
			flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).minimum=minyValue;
			flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).maximum=maxyValue;
			if(status=="Init"){
				flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).values=[minyValue, maxyValue];
			}
		}
	}
    
 private function xAxisTypeChange(event:Event):void{
 	accordionIndex=leftAccordion.selectedIndex+1
	cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
	HBoxMinMaxx=HBox(cnvs.getChildByName("cnvs"+accordionIndex+"_HBoxMinMaxx"))
		if(event.target.selectedLabel.toString()=="Category"){
    		Label(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_lblxMin1")).setStyle("color", 0xCCCCCC);
    		Label(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_lblxMax1")).setStyle("color", 0xCCCCCC);
    		Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblxInterval1")).setStyle("color", 0xCCCCCC);
    		flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).setStyle("color", 0xCCCCCC);
    		flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).alpha=0.3;
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtxInterval1")).setStyle("color", 0xCCCCCC);
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtxInterval1")).alpha=0.3;
    	}else{
    		Label(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_lblxMin1")).setStyle("color", 0x000000);
    		Label(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_lblxMax1")).setStyle("color", 0x000000);
    		Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblxInterval1")).setStyle("color", 0x000000);
    		flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).setStyle("color", 0x000000);
    		flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).alpha=1;
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtxInterval1")).setStyle("color", 0x000000);
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtxInterval1")).alpha=1;
    		FindMinMax("x","Init");
    	}
    	refreshChart();
    }
    
    
	
    private function yAxisTypeChange(event:Event):void{
    	accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		HBoxMinMaxy=HBox(cnvs.getChildByName("cnvs"+accordionIndex+"_HBoxMinMaxy"))
    	if(event.target.selectedLabel.toString()=="Category"){
    		Label(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_lblyMin1")).setStyle("color", 0xCCCCCC);
    		Label(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_lblyMax1")).setStyle("color", 0xCCCCCC);
    		Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblyInterval1")).setStyle("color", 0xCCCCCC);
    		flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).setStyle("color", 0xCCCCCC);
    		flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).alpha=0.3;
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtyInterval1")).setStyle("color", 0xCCCCCC);
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtyInterval1")).alpha=0.3;
    	}else{
    		Label(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_lblyMin1")).setStyle("color", 0x000000);
    		Label(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_lblyMax1")).setStyle("color", 0x000000);
    		Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblyInterval1")).setStyle("color", 0x000000);
    		flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).setStyle("color", 0x000000);
    		flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).alpha=1;
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtyInterval1")).setStyle("color", 0x000000);
    		NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtyInterval1")).alpha=1;
    		FindMinMax("y","Init");
    		
    	}
    	
    	refreshChart();
    }
    
    public function refreshChart():void {
    	accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
    	var strChartType:String = ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()
    	drawChart(strChartType);
    }
    
     public function refreshChartEvent(event:Event):void {
     	accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
    	var strChartType:String = ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()
    	drawChart(strChartType);
    }
  
    private function refreshCartChartEvent(event:Event):void {
    	accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
    	num=event.target.name.substr(17);
    	if(event.target.selectedLabel.toString()=="Area" || event.target.selectedLabel.toString()=="Line")
    	{
    		if (num==1)
				{
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblRadius"+num)).setStyle("color", 0xCCCCCC);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCatForm"+num)).setStyle("color", 0x000000);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblxAxis"+num)).text="xAxis :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblyAxis"+num)).text="yAxis :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblOpenField"+num)).setStyle("color", 0xCCCCCC);
    			Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCloseField"+num)).setStyle("color", 0xCCCCCC);
					
				}else{
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).prompt="Select...";
    				//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+98);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+68);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+8);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).move(3, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).alpha=0.3;
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).setStyle("color", 0xCCCCCC);
				}
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).alpha=0.3;	
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).setStyle("color", 0xCCCCCC);	
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).alpha=1;
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).setStyle("color", 0x000000);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).alpha=0.3;
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).alpha=0.3;
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).setStyle("color", 0xCCCCCC);
    	}else if (event.target.selectedLabel.toString()=="Bubble"){
    		if (num==1)
			{
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCatForm"+num)).setStyle("color", 0xCCCCCC);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblRadius"+num)).setStyle("color", 0x000000);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblxAxis"+num)).text="xAxis :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblyAxis"+num)).text="yAxis :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblOpenField"+num)).setStyle("color", 0xCCCCCC);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCloseField"+num)).setStyle("color", 0xCCCCCC);
    		}else{
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).prompt="Select...";
    			//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+98);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+68);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+8);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).move(3, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).alpha=0.3;
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).setStyle("color", 0xCCCCCC);
			}
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).alpha=1;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).setStyle("color", 0x000000);
    		
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).alpha=0.3;
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).setStyle("color", 0xCCCCCC);
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).setStyle("color", 0xCCCCCC);
    	}else if (event.target.selectedLabel.toString()=="Candlestick" || event.target.selectedLabel.toString()=="HLOC"){
    		if (num==1)
			{
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblRadius"+num)).setStyle("color", 0xCCCCCC);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCatForm"+num)).setStyle("color", 0xCCCCCC);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblxAxis"+num)).text="High Field :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblyAxis"+num)).text="Low Field :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblOpenField"+num)).setStyle("color", 0x000000);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCloseField"+num)).setStyle("color", 0x000000);
    		}else{
    				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).prompt="Low Field...";
    				//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+128);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+98);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+68);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).move(85, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+8);
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).alpha=1;
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).setStyle("color", 0x000000);
    		}
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).alpha=0.3;	
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).setStyle("color", 0xCCCCCC);	
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).alpha=1;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).setStyle("color", 0x000000);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).alpha=1;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).setStyle("color", 0x000000);
    	}else{
    		if (num==1)
				{
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCatForm"+num)).setStyle("color", 0xCCCCCC);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblRadius"+num)).setStyle("color", 0xCCCCCC);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCatForm"+num)).setStyle("color", 0xCCCCCC);
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblxAxis"+num)).text="xAxis :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblyAxis"+num)).text="yAxis :";
					Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblOpenField"+num)).setStyle("color", 0xCCCCCC);
    				Label(cnvs.getChildByName("cnvs"+accordionIndex+"_lblCloseField"+num)).setStyle("color", 0xCCCCCC);
				}else{
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).prompt="Select...";
    				//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+98);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+68);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+8);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).move(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num).x, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					//ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).move(3, cnvs.getChildByName("cnvs"+accordionIndex+"_sep"+num).y+38);
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).alpha=0.3;
					ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).setStyle("color", 0xCCCCCC);
				}
				
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).setStyle("color", 0xCCCCCC);
    		ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).alpha=0.3;
				ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).setStyle("color", 0xCCCCCC);
    	}
    	refreshChart();
    }
   
   public function createNextPod(num:int):void{
   	if ((arrNewPod[num]==true) ){
			//crÃ©ation du nouveau Pod
				var nextPod:Pod = new Pod();
				nextPod.addEventListener(FlexEvent.UPDATE_COMPLETE, onCreationCompletePod);
				nextPod.id = "Pod"+(num);//leftAccordion.numChildren+1
				addPod(nextPod, num, nextPod.id);
				arrPods[num]=nextPod;
				//createNewPod=false;
				arrNewPod[num]=false;
				//updateLayout(true);
				//dispatchEvent(new LayoutChangeEvent(LayoutChangeEvent.UPDATE));
				//var strChartType:String = ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()
				//drawChart(strChartType);
				refreshChart();
		}
   }
   
    //function qui crÃ©Ã© le graphique en fonction des paramÃ¨tres sÃ©lÃ©ctionnÃ©s depuis le tableau de bord
    public function drawChart(strChartType:String):void {
    	accordionIndex=leftAccordion.selectedIndex+1
    	numOfPiano=leftAccordion.numChildren+1
    	//Alert.show(accordionIndex.toString() + ' / ' +numOfPiano.toString());
    	if(arrNewPod[accordionIndex]==true){
    		pianoNumber=numOfPiano;
    	}else{
    		pianoNumber=accordionIndex;
    	}
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		
		if (myChart.chart.(@Type==strChartType).Properties.Property.(@name=="Axis").length() !=0){
    		FindMinMax("x","");
			FindMinMax("y","");
			xField="@"+ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis1")).selectedLabel.toString();
    	}
    	//p1.removeAllChildren();
    	//showhideCartesianSerie(strChartType);
		if (myChart.chart.(@Type==strChartType).Properties.Property.(@name=="barTypes").length() !=0){
    		DisplayType=ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbDisplay")).selectedLabel.toString();
    	}
		//createNextPod();
		
    	switch (strChartType) { 
		    case "Area" : 
		    	drawAreaChart();
		    	break; 
		    case "Bar" : 
		    	drawBarChart();
		        break; 
		    case "Bubble" : 
		        drawBubbleChart();
		        break; 
		    case "Candlestick" : 
		        drawCandlestickChart();
		        break; 
		    case "Column" : 
		        drawColumnChart();
		        break; 
		    case "HighLowOpenClose" : 
		        drawHLOCChart()
		        break; 
		    case "Line" : 
		    	drawLineChart();
		        break; 
		    case "Pie" : 
		        drawPieChart();
		        break; 
		    case "Plot" : 
		        drawPlotChart();
		        break;
		    case "Radar" : 
		        drawRadarChart();
		        break;
		    case "TreeMap" : 
		        drawTreeMap();
		        break;
		    case "GeoMap" : 
		        drawGeoMap();
		        break; 
		   case "Cartesian" : 
		        drawCartesianChart();
		        break; 
		}
	}
    
    public function createLegend(Chart:Object):void {
    	accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
    	var myLegend:Legend = new Legend();
		myLegend.dataProvider = Chart;
		myLegend.direction = "horizontal";
		if(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkLegend")).selected){
			this.addChild(myLegend);
		}
	}
	
	// Test
	public function createLegend2(Chart:Object, container:VBox):void {
    	accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
    	var myLegend:Legend = new Legend();
		myLegend.dataProvider = Chart;
		myLegend.direction = "horizontal";
		if(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkLegend")).selected){
			container.addChild(myLegend);
		}
	}
	
	public function addGridLines(Chart:Object):void {
		accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		var bge:GridLines;
		bge = new GridLines();
		bge.setStyle("direction", "both");
		var s:Stroke
		if(CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkGrid")).selected)
		{
			s = new Stroke(0x9BC4E2,1);
			bge.setStyle("horizontalStroke", s);
			bge.setStyle("verticalStroke",s);
						
		}else{
			s = new Stroke(0xFFFFFF,0);
			bge.setStyle("horizontalStroke", s);
			bge.setStyle("verticalStroke",s);
		}
		Chart.backgroundElements =[bge];
	}
	
	public function sortLabel(sField:String):void{
		dataSort=new Sort();
		dataSort.fields=[new SortField(sField,true)];//"@amount"
		dataListCollection.sort=dataSort;
		dataListCollection.refresh();
	}
	
	public function setMinMaxInt(axis:Object,orientation:String):void{
		accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		HBoxMinMaxx=HBox(cnvs.getChildByName("cnvs"+accordionIndex+"_HBoxMinMaxx"))
		HBoxMinMaxy=HBox(cnvs.getChildByName("cnvs"+accordionIndex+"_HBoxMinMaxy"))
		if(orientation=="h"){
			if (flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).values[1]!=""){
    			axis.maximum=flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).values[1];
    		}
    		if (flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).values[0]!=""){
    			axis.minimum=flexlib.controls.HSlider(HBoxMinMaxx.getChildByName("cnvs"+accordionIndex+"_minMaxxSlider")).values[0];
    		}
    		if (NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtxInterval1")).value.toString()!=""){
    			axis.interval=NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtxInterval1")).value.toString();
    		}
		}else{
			if (flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).values[1]!=""){
    			axis.maximum=flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).values[1];
    		}
    		if (flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).values[0]!=""){
    			axis.minimum=flexlib.controls.HSlider(HBoxMinMaxy.getChildByName("cnvs"+accordionIndex+"_minMaxySlider")).values[0];
    		}
    		if (NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtyInterval1")).value.toString()!=""){
    			axis.interval=NumericStepper(cnvs.getChildByName("cnvs"+accordionIndex+"_txtyInterval1")).value.toString();
    		}
		}
	}
	
	
    public function setTypeAxis(Chart:Object,AxisType:String,axe:String):void { 
    	switch (AxisType) { 
		    case "Category" : 
		    	var AxisCat:CategoryAxis = new CategoryAxis();
		    	AxisCat.categoryField = xField;
		    	sortLabel(xField);
		    	AxisCat.dataProvider = dataListCollection;//xmlDataModif.children()//xmlData.children();
		    	
		    	if(axe=="h"){
		    		//AxisCat.categoryField=xField;//CategoryxField;
					Chart.horizontalAxis = AxisCat;
		    	}else{
		    		//AxisCat.categoryField=yField;//CategoryyField;
		    		//Chart.verticalAxis = AxisCat;
		    	}
		        break; 
		    case "Linear" : 
		    	var AxisLinear:LinearAxis = new LinearAxis();
		    	setMinMaxInt(AxisLinear,axe);
		    	if(axe=="h"){
					Chart.horizontalAxis = AxisLinear;
		    	}else{
		    		Chart.verticalAxis = AxisLinear;
		    	}
		    	
		        break;
			case "Log" : 
		    	var AxisLog:LogAxis = new LogAxis();
		    	setMinMaxInt(AxisLog,axe);
		    	if(axe=="h"){
					Chart.horizontalAxis = AxisLog;
		    	}else{
		    		Chart.verticalAxis = AxisLog;
		    	}
		        break; 
		    case "DateTime" : 
		    	var AxisDateTime:DateTimeAxis = new DateTimeAxis();
		    	setMinMaxInt(AxisDateTime,axe);
		    	if(axe=="h"){
					Chart.horizontalAxis = AxisDateTime;
		    	}else{
		    		Chart.verticalAxis = AxisDateTime;
		    	}
		        break; 
        }
	}
	
	
	
	public function setSerie(serie:Object,chartType:String, syField:String, num:int):void{
		accordionIndex=leftAccordion.selectedIndex+1
		cnvs=Canvas(leftAccordion.getChildByName("piano"+accordionIndex))
		if(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()=="Pie")
		{
			serie.field=syField;
			serie.nameField=syField;
			serie.setStyle("labelPosition", ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbLabelPosition")).selectedLabel.toString()); 
			
			serie.explodeRadius=flexlib.controls.HSlider(cnvs.getChildByName("cnvs"+accordionIndex+"_PieExplode")).value//.12
			serie.startAngle=flexlib.controls.HSlider(cnvs.getChildByName("cnvs"+accordionIndex+"_PieAngle")).value;
		}else if (ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()=="Candlestick" || ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()=="HighLowOpenClose"){
			serie.openField=openField;
			serie.closeField=closeField;
			serie.highField=highField;
			serie.lowField=lowField;
		}else if (ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()=="Cartesian"){
			if(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).selectedLabel.toString()=="Candlestick" || ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).selectedLabel.toString()=="HLOC"){
				serie.openField=openField;
				serie.closeField=closeField;
				serie.highField=highField;
				serie.lowField=lowField;
			}else{
				serie.xField=xField;
				serie.yField=syField;
				serie.displayName = syField.substring(1,syField.length);
			}
		}
		else if (ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()=="Radar"){
			serie.dataField=dataField;
			
		}else{
			serie.xField=xField;
			serie.yField=syField;
			serie.displayName = syField.substring(1,syField.length);
		}
		
		if (myChart.chart.(@Type==chartType).Properties.Property.Forms.length() !=0)
		{
		if(ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbChartType")).selectedLabel.toString()=="Cartesian")
			{
				serie.setStyle('form', ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartForm"+num)).text)
			}else{
				serie.setStyle('form', ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbForm")).text);
			}
		}
		if (myChart.chart.(@Type==chartType).Properties.Property.(@name=="Fill").length() !=0)
		{
			f=new SolidColor(ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+num)).selectedColor,1);
				s = new Stroke(ColorPicker(cnvs.getChildByName("cnvs"+accordionIndex+"_cp"+num)).selectedColor,1);
				if(chartType=="Area"){
					serie.setStyle('areaFill',f);
				}else if(chartType=="Line"){
					serie.setStyle('fill',f);
					serie.setStyle('lineStroke',s);
				}else if(chartType=="Candlestick"){
					serie.setStyle('declineFill',f);
					serie.setStyle('stroke',s);
					serie.setStyle('boxStroke',s);
				}else if(chartType=="HighLowOpenClose"){
					serie.setStyle('openTickStroke',s);
					serie.setStyle('stroke',s);
					serie.setStyle('closeTickStroke',s);
				}else{
					serie.setStyle('fill',f);
				}
		}
	}
	
	public function resizeChart(Chart:Object):void{
		Chart.percentHeight=(80*p1.height)/100;
		Chart.percentWidth=(80*p1.width)/100;
	}
	
     public function drawAreaChart():void {
     	var chartVBox:VBox = new VBox();
     	var myAreaSeries:Array=new Array();
    	var myAreaChart:AreaChart;
    	var AreaSerie1:AreaSeries;
	    myAreaChart = new AreaChart();
        myAreaChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myAreaChart.dataProvider=dataListCollection;//xmlDataModif.children()//xmlData.children();//slicedResults;////expenses;
    	myAreaChart.percentWidth=100;
    	myAreaChart.percentHeight=100;
    	
    	
    	if (numberOfSerie[accordionIndex]>1){
    		myAreaChart.type=DisplayType;
    	}
    	
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		AreaSerie1=new AreaSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(AreaSerie1,'Area',yField,num);
			myAreaSeries.push(AreaSerie1);
		}	
		
		// Define the horizontal axis.
       setTypeAxis(myAreaChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myAreaChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");		
		
		myAreaChart.series = myAreaSeries;
		
		resizeChart(chartVBox);
		//chartVBox.removeAllChildren();
		chartVBox.addChild(myAreaChart);
		
		var podContent:PodContentBase = new PodContentBase();
		//podContent.removeAllChildren();
	  	podContent.addChild(chartVBox);
		//var areaPod:Pod = new Pod();
	  	//areaPod.addChild(podContent);  
	 
	  	createNextPod(accordionIndex);
	  	
	  	Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Area";
	  	// Listen for the last pod to complete so the layout from the ContainerWindowManager is done correctly. 
		//		piePod.addEventListener(FlexEvent.UPDATE_COMPLETE, onCreationCompletePod);
		//areaPod.id = "areaPod"+accordionIndex;
		//areaPod.title = "Area"+accordionIndex;
		//addPod(areaPod, accordionIndex, areaPod.id);//2
		//Alert.show(Pod(arrPods[accordionIndex]).id);
    	
		//Alert.show(Pod(arrPods[1]).id);
		// Create a legend.
		createLegend2(myAreaChart, chartVBox);
		addGridLines(myAreaChart);
		}
    
    
    private function drawBarChart():void {
    	var chartVBox:VBox = new VBox();
    	var myBarSeries:Array=new Array();
	    var myBarChart:BarChart;
        var barSeries1:BarSeries;
        
        myBarChart = new BarChart();
        myBarChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myBarChart.dataProvider=dataListCollection;//xmlData.children()//"{data.value}";//expenses//"{myAC}";//"{results.value}";//"{myData.lastResult.value}";//expenses;
        
    	
        if (numberOfSerie[accordionIndex]>1){
    		myBarChart.type=DisplayType;
    	}
    	
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		barSeries1=new BarSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(barSeries1,'Bar',yField,num);
			myBarSeries.push(barSeries1);
		}
		
       // Define the horizontal axis.
       setTypeAxis(myBarChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myBarChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");	
		
		myBarChart.series = myBarSeries;
		resizeChart(myBarChart);
		resizeChart(chartVBox);
		chartVBox.addChild(myBarChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Bar";
	  	createLegend2(myBarChart, chartVBox);
	  	
		addGridLines(myBarChart);
    }
    
    private function drawBubbleChart():void {
    	var chartVBox:VBox = new VBox();
    	var myBubbleSeries:Array=new Array();
	    var MyBubbleChart:BubbleChart;
        var Bubbleseries1:BubbleSeries;
     
        MyBubbleChart = new BubbleChart();
        MyBubbleChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        MyBubbleChart.dataProvider=dataListCollection;//xmlData.children()//expenses;
		
		
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		Bubbleseries1=new BubbleSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			rField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).selectedLabel.toString();
			setSerie(Bubbleseries1,'Bubble',yField,num);
			Bubbleseries1.radiusField=rField;//"@amount";
			myBubbleSeries.push(Bubbleseries1);
		}
		
	   // Define the horizontal axis.
       setTypeAxis(MyBubbleChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(MyBubbleChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
	   
		
		MyBubbleChart.series = myBubbleSeries;
		resizeChart(MyBubbleChart);
		resizeChart(chartVBox);
		chartVBox.addChild(MyBubbleChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Bubble";
	  	createLegend2(MyBubbleChart, chartVBox);
	  	addGridLines(MyBubbleChart);
    }
    
    
    private function drawCandlestickChart():void {
    	var chartVBox:VBox = new VBox();
    	var myCandlestickSeries:Array=new Array();
	    var myCandlestickChart:CandlestickChart;
        var CandlestickSeries1:CandlestickSeries;
        
        myCandlestickChart = new CandlestickChart();
        myCandlestickChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myCandlestickChart.dataProvider=dataListCollection;//xmlData.children();
        
       
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		CandlestickSeries1=new CandlestickSeries();
    		highField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).selectedLabel.toString();
    		lowField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
    		openField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).selectedLabel.toString();
    		closeField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).selectedLabel.toString();
			setSerie(CandlestickSeries1,'Candlestick',"",num);
			myCandlestickSeries.push(CandlestickSeries1);
		}
		
       // Define the horizontal axis.
       setTypeAxis(myCandlestickChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myCandlestickChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
		
		myCandlestickChart.series = myCandlestickSeries;
		resizeChart(myCandlestickChart);
		resizeChart(chartVBox);
		chartVBox.addChild(myCandlestickChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Candlestick";
	  	createLegend2(myCandlestickChart, chartVBox);  
		addGridLines(myCandlestickChart);
    }
    
    private function drawColumnChart():void {
    	var chartVBox:VBox = new VBox();
		var myColumnSeries:Array=new Array();
	    var myColumnChart:ColumnChart;
        var ColumnSeries1:ColumnSeries;
        
        myColumnChart = new ColumnChart();
        myColumnChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myColumnChart.dataProvider=dataListCollection;//xmlData.children();
        
        if (numberOfSerie[accordionIndex]>1){
    		myColumnChart.type=DisplayType;
    	}
    	
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		ColumnSeries1=new ColumnSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(ColumnSeries1,'Column',yField,num);
			myColumnSeries.push(ColumnSeries1);
		}
		
       // Define the horizontal axis.
       setTypeAxis(myColumnChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myColumnChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
		
		myColumnChart.series = myColumnSeries;
		resizeChart(myColumnChart);
		resizeChart(chartVBox);
		chartVBox.addChild(myColumnChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Column";
	  	createLegend2(myColumnChart, chartVBox);  
		addGridLines(myColumnChart);
    }
    
    private function drawHLOCChart():void {
    	var chartVBox:VBox = new VBox();
    	var myHLOCSeries:Array=new Array();
	    var myHLOCChart:HLOCChart;
        var HLOCSeries1:HLOCSeries;
        
        myHLOCChart = new HLOCChart();
        myHLOCChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myHLOCChart.dataProvider=dataListCollection;//xmlData.children();
        
    	
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		HLOCSeries1=new HLOCSeries();
    		highField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).selectedLabel.toString();
    		lowField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
    		openField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).selectedLabel.toString();
    		closeField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).selectedLabel.toString();
			setSerie(HLOCSeries1,'Candlestick',"",num);
			myHLOCSeries.push(HLOCSeries1);
		}
		
       // Define the horizontal axis.
       setTypeAxis(myHLOCChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myHLOCChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
		
		myHLOCChart.series = myHLOCSeries;
		resizeChart(myHLOCChart);
		resizeChart(chartVBox);
		chartVBox.addChild(myHLOCChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". HLOC";
	  	createLegend2(myHLOCChart, chartVBox); 
		addGridLines(myHLOCChart);
    }
    
    private function drawLineChart():void {
    	var chartVBox:VBox = new VBox();
    	var myLineSeries:Array=new Array();
		var MyLineChart:LineChart;
		var LineSeries1:LineSeries;
		
		MyLineChart = new LineChart();
        MyLineChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        MyLineChart.dataProvider=dataListCollection;//xmlData.children();//expenses;
    	
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		LineSeries1=new LineSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(LineSeries1,'Line',yField,num);
			myLineSeries.push(LineSeries1);
		}
		
       // Define the horizontal axis.
       setTypeAxis(MyLineChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(MyLineChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
		
		MyLineChart.series = myLineSeries;
		resizeChart(MyLineChart);
		resizeChart(chartVBox);
		chartVBox.addChild(MyLineChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Line";
	  	createLegend2(MyLineChart, chartVBox);
		addGridLines(MyLineChart);
    }

    
    private function drawPieChart():void {
    	
    	var chartVBox:VBox = new VBox();
    	var myPieSeries:Array=new Array();
		var MyPieChart:PieChart;
		var PieSeries1:PieSeries;
		
		MyPieChart = new PieChart();
        MyPieChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        MyPieChart.dataProvider=dataListCollection;//xmlData.children();//expenses;
        MyPieChart.percentHeight=100;
        MyPieChart.percentWidth=100;
    	
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		PieSeries1=new PieSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(PieSeries1,'Pie',yField,num);
			//PieSeries1.startAngle=PieAngleSlider.value;
			myPieSeries.push(PieSeries1);
		}
		MyPieChart.setStyle("innerRadius", flexlib.controls.HSlider(cnvs.getChildByName("cnvs"+accordionIndex+"_PieDonuts")).value.toString()); 
       	MyPieChart.series = myPieSeries;
		resizeChart(MyPieChart);
		// Attach chart and legend to the display list.
		// p1.addChild(MyPieChart);
		resizeChart(chartVBox);
		chartVBox.addChild(MyPieChart);
		
		var podContent:PodContentBase = new PodContentBase();
	  	podContent.addChild(chartVBox);
	  	createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Pie";

		
		// Create a legend.
		createLegend2(MyPieChart, chartVBox);
    }
    
    private function drawPlotChart():void {
	    
	    var chartVBox:VBox = new VBox();
	    
	    var myPlotSeries:Array=new Array();
		var myPlotChart:PlotChart;
        var PlotSeries1:PlotSeries;
        myPlotChart = new PlotChart();
        myPlotChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myPlotChart.dataProvider=dataListCollection;//xmlData.children();
        myPlotChart.percentHeight=100;
        myPlotChart.percentWidth=100;
        
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		PlotSeries1=new PlotSeries();
    		yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(PlotSeries1,'Plot',yField,num);
			myPlotSeries.push(PlotSeries1);
		}
		
       // Define the horizontal axis.
       setTypeAxis(myPlotChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myPlotChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
	
		myPlotChart.series = myPlotSeries;
		resizeChart(myPlotChart);
		resizeChart(chartVBox);
		chartVBox.addChild(myPlotChart);
					
		var podContent:PodContentBase = new PodContentBase();
	  	podContent.addChild(chartVBox);
	  	createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Plot";
	  	
		// Create a legend.
		createLegend2(myPlotChart, chartVBox);   
		addGridLines(myPlotChart); 
    }
       
	// The following are ILOG Chart Components
	    
    private function drawRadarChart():void {
	// ILOG component
    
    /*
    <ilog:RadarChart dataProvider="{temperature}">
   <ilog:angularAxis>
     <ilog:AngularAxis categoryField="Month" displayName="Month"/>
   </ilog:angularAxis>
   <ilog:radialAxis>
     <mx:LinearAxis  displayName="Temperature (ËF)"/>
   </ilog:radialAxis>
   <ilog:series>
     <series:RadarLineSeries dataField="London" displayName="London"/>
     <series:RadarLineSeries dataField="Sydney" displayName="Sydney"/>
   </ilog:series>
</ilog:RadarChart>
*/
        var chartVBox:VBox = new VBox();
	    
	    var myRadarLineSeries:Array=new Array();
	    var myRadarBubbleSeries:Array=new Array();
	    var myRadarPlotSeries:Array=new Array();
	    var myRadarColumnSeries:Array=new Array();
	    
		var myRadarChart:RadarChart;
        var RadarLineSeries1:RadarLineSeries = new RadarLineSeries();
        var RadarBubbleSeries1:RadarBubbleSeries = new RadarBubbleSeries();
        var RadarPlotSeries1:RadarPlotSeries = new RadarPlotSeries();
        var RadarColumnSeries1:RadarColumnSeries = new RadarColumnSeries();
        
        var angularAxis1:AngularAxis = new AngularAxis();
        var radialAxis1:LinearAxis = new LinearAxis();
        
        angularAxis1.categoryField="@nodeType";
         
        RadarLineSeries1.dataField="@nodeId";
        myRadarLineSeries.push(RadarLineSeries1);
        
        myRadarChart = new RadarChart();
        myRadarChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myRadarChart.dataProvider=dataListCollection;//xmlData.children();
        myRadarChart.percentHeight=100;
        myRadarChart.percentWidth=100;
        myRadarChart.angularAxis = angularAxis1;
        myRadarChart.radialAxis = radialAxis1;
        myRadarChart.series = myRadarLineSeries;   
        
        /*
        for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		RadarLineSeries1=new RadarLineSeries();
    		dataField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(RadarLineSeries1,'Radar',dataField,num);
			myRadarLineSeries.push(RadarLineSeries1);
		}
		*/
		
       // Define the Angular axis.
       // setTypeAxis(myRadarChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the Radial axis.
	   // setTypeAxis(myRadarChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
	
		
		
		resizeChart(chartVBox);
		chartVBox.addChild(myRadarChart);
					
		var podContent:PodContentBase = new PodContentBase();
	  	podContent.addChild(chartVBox);
		//var radarPod:Pod = new Pod();
	  	//radarPod.addChild(podContent);  
	  	
	  	// Listen for the last pod to complete so the layout from the ContainerWindowManager is done correctly. 
		//		plotPod.addEventListener(FlexEvent.UPDATE_COMPLETE, onCreationCompletePod);
				//radarPod.id = "radarPod"+accordionIndex;
				//radarPod.title = "RadarChart";
		
		
		//addPod(radarPod, 3, radarPod.id);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Radar";
		// Create a legend.
		createLegend2(myRadarChart, chartVBox);   
		// addGridLines(myRadarChart);
    	    			
    }
    
    private function drawTreeMap():void {
    // ILOG component	
    
    var myTreeMap:TreeMap = new TreeMap();
	        
	    myTreeMap = new TreeMap();
        myTreeMap.dataProvider=new HierarchicalData(myTreeData);//xmlData.children();
        
        myTreeMap.algorithm="squarified";
        myTreeMap.areaField="@id";
        myTreeMap.colorField="@id";
        myTreeMap.labelField="@name";
        myTreeMap.labelThreshold=2;
        myTreeMap.setStyle('colorScheme', "div-green-red");
        myTreeMap.setStyle('topMarginProportion', 0.2);
        myTreeMap.setStyle('backgroundColor', 0xFFFFFF);
        myTreeMap.setStyle('textBackgroundColor', 0xFFFFFF);
        myTreeMap.setStyle('borderColor', 0x000000);
		myTreeMap.setStyle('borderThickness', 1);
		myTreeMap.setStyle('backgroundColor', 0xFFFFFF);
	
        /*
        for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
    		RadarLineSeries1=new RadarLineSeries();
    		dataField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
			setSerie(RadarLineSeries1,'Radar',dataField,num);
			myRadarLineSeries.push(RadarLineSeries1);
		}
		*/
       
		
		resizeChart(myTreeMap);
					
		var podContent:PodContentBase = new PodContentBase();
	  	podContent.addChild(myTreeMap);
		//var treeMapPod:Pod = new Pod();
	  	//treeMapPod.addChild(podContent);  
	  	
	  	// Listen for the last pod to complete so the layout from the ContainerWindowManager is done correctly. 
		//		plotPod.addEventListener(FlexEvent.UPDATE_COMPLETE, onCreationCompletePod);
		//		treeMapPod.id = "treeMapPod"+accordionIndex;
		//		treeMapPod.title = "TreeMap";
		
		
		//addPod(treeMapPod, 6, treeMapPod.id);	
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". TreeMap";
    }
    
    private function drawGeoMap():void {
    // ILOG component
    
	        
      // Create a map of World Countries.
      var myGeoMap:WorldCountriesMap = new WorldCountriesMap();
       //myGeoMap.allowNavigation=true;
  	   //myGeoMap.zoomableSymbols=true;
  	  
  	   //myGeoMap.setStyle('backgroundFill', 0xFFFFFF);
  	   //myGeoMap.setStyle('fill', 0xFFFFFF);
  	   //myGeoMap.setStyle('highlightStroke', 0x000000);
  	   //myGeoMap.setStyle('stroke', 0x000000);
  	  
  	  // myGeoMap.percentHeight=100;
  	  // myGeoMap.percentWidth=100;
  	  	resizeChart(myGeoMap);		
		var podContent:PodContentBase = new PodContentBase();
	  	podContent.addChild(myGeoMap);
		
		createNextPod(accordionIndex);
	  	Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". GeoMap";
    }
	
	// End ILOG Chart Components
	
   	private function drawCartesianChart():void{
   		var chartVBox:VBox = new VBox();
   		var myCartesianSeries:Array=new Array();
    	var myCartesianChart:CartesianChart;
    	
    	myCartesianChart = new CartesianChart();
        myCartesianChart.showDataTips = CheckBox(cnvs.getChildByName("cnvs"+accordionIndex+"_chkDataType")).selected;
        myCartesianChart.dataProvider=dataListCollection;//xmlDataModif.children()//xmlData.children();//slicedResults;////expenses;
    	for (num=1; num<=numberOfSerie[accordionIndex]; num++) {
			yField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
				
			switch (ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCartSerie"+num)).selectedLabel.toString()) { 
		    case "Area" : 
		    	var cartAreaSerie:AreaSeries;
		    	cartAreaSerie=new AreaSeries();
		    	setSerie(cartAreaSerie,'Area',yField,num);
				myCartesianSeries.push(cartAreaSerie);
		    	break; 
		    case "Bar" : 
		    	var cartBarSerie:BarSeries;
		    	cartBarSerie=new BarSeries();
		    	setSerie(cartBarSerie,'Bar',yField,num);
				myCartesianSeries.push(cartBarSerie);
		        break; 
		    case "Bubble" : 
		        var cartBubbleSerie:BubbleSeries;
		    	cartBubbleSerie=new BubbleSeries();
		    	rField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbRadius"+num)).selectedLabel.toString();
		    	setSerie(cartBubbleSerie,'Bubble',yField,num);
					cartBubbleSerie.radiusField=rField;
					myCartesianSeries.push(cartBubbleSerie);
		        break; 
		    case "Candlestick" : 
		        var cartCandlestickSerie:CandlestickSeries;
		    	cartCandlestickSerie=new CandlestickSeries();
		    	highField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).selectedLabel.toString();
	    		lowField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
	    		openField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).selectedLabel.toString();
	    		closeField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).selectedLabel.toString();
		    	setSerie(cartCandlestickSerie,'Candlestick',"",num);
				myCartesianSeries.push(cartCandlestickSerie);
		        break; 
		    case "Column" : 
		        var cartColumnSerie:ColumnSeries;
		    	cartColumnSerie=new ColumnSeries();
		    	setSerie(cartColumnSerie,'Column',yField,num);
				myCartesianSeries.push(cartColumnSerie);
		        break; 
		    case "HLOC" : 
		        var cartHLOCSerie:HLOCSeries;
		    	cartHLOCSerie=new HLOCSeries();
		    	highField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxis"+num)).selectedLabel.toString();
	    		lowField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxis"+num)).selectedLabel.toString();
	    		openField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbOpenField"+num)).selectedLabel.toString();
	    		closeField="@"+  ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbCloseField"+num)).selectedLabel.toString();
		    	setSerie(cartHLOCSerie,'HighLowOpenClose',yField,num);
				myCartesianSeries.push(cartHLOCSerie);
		        break; 
		    case "Line" : 
		    	var cartLineSerie:LineSeries;
		    	cartLineSerie=new LineSeries();
		    	setSerie(cartLineSerie,'Line',yField,num);
				myCartesianSeries.push(cartLineSerie);
		        break; 
		    case "Plot" : 
		        var cartPlotSerie:PlotSeries;
		    	cartPlotSerie=new PlotSeries();
		    	setSerie(cartPlotSerie,'Plot',yField,num);
				myCartesianSeries.push(cartPlotSerie);
		        break;
		     
		}
	    		
			}
		
		// Define the horizontal axis.
       setTypeAxis(myCartesianChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbxAxisType1")).text,"h");
	   // Define the vertical axis.
	   setTypeAxis(myCartesianChart,ComboBox(cnvs.getChildByName("cnvs"+accordionIndex+"_cbyAxisType1")).text,"v");
	   
	   
		myCartesianChart.series = myCartesianSeries;
		resizeChart(myCartesianChart);
		resizeChart(chartVBox);
		chartVBox.addChild(myCartesianChart);
		
		var podContent:PodContentBase = new PodContentBase();
		podContent.addChild(chartVBox);
		createNextPod(accordionIndex);
		Pod(arrPods[accordionIndex]).removeAllChildren();
	  	Pod(arrPods[accordionIndex]).addChild(podContent); 
	  	Pod(arrPods[accordionIndex]).title= accordionIndex + ". Cartesian";
	  	createLegend2(myCartesianChart, chartVBox);  
		addGridLines(myCartesianChart);
   	}
    
    
    public function sliceResults(): void {
		
		/*var minSlider:int=int(minMaxySlider.values[0])
		var maxSlider:int=int(minMaxySlider.values[1])
		var newRootXml:XML = <root/>;
		
		for (var i:int = 0; i < dataList.length(); i++) 
		{ 
			var eachProduct:XML = dataList[i];
			
			if((i>minSlider) && (i<maxSlider)){
				Alert.show(eachProduct.toXMLString(), 'Alert Box',mx.controls.Alert.OK);
				newRootXml.appendChild(eachProduct);
			}
		} 
		dataList=newRootXml.children();
		dataListCollection=new XMLListCollection(dataList);
		dataListCollection.refresh();
		//Alert.show(dataList.toString(), 'Alert Box',mx.controls.Alert.OK);
		*/
		refreshChart();
    }
    
  /* function getDataTip(obj) {
            var item=obj.hitData.item;
            return "<b>"+item.month+"</b><br>Profit: "+item.profit+"<br>Expenses: "+item.expenses+"<br>Amount: "+item.amount;
        }*/
        
        private function degrees_func(item:Number):String {
                return item + String.fromCharCode(176);
                
            }

]]>
</mx:Script>

	<!-- Effects -->
	<mx:WipeLeft id="wipeLeft" duration="1000" />
	<mx:WipeRight id="wipeRight" duration="1000" />
	
	<mx:Number id="numberItems"/>
	<mx:Number id="maxxSlideValue"/>
	<mx:Number id="maxxSlideDefault"/>
	<mx:Number id="maxySlideValue"/>
	<mx:Number id="maxySlideDefault"/>
	<mx:HBox id="DivNavRB" width="100%" height="100%" paddingBottom="5" horizontalGap="5" y="1" x="0">
		<mx:HBox id="sideBar" width="300" height="100%" horizontalGap="0" >
	<ui:Grip id="navGrip" 
				width="17" height="100%" horizontalAlign="center"
				gripTip="Show/Hide Control Panel" />
	<mx:VBox id="NavContainerRB" horizontalScrollPolicy="off" verticalScrollPolicy="off" verticalAlign="middle" horizontalAlign="center" verticalGap="1" horizontalGap="0" width="100%" height="100%" hideEffect="{wipeLeft}" showEffect="{wipeRight}">
	<mx:Accordion id="leftAccordion" headerRenderer="org.un.birdeye.measure.renderers.HeaderRenderer" paddingBottom="5" paddingRight="5" paddingTop="5" paddingLeft="5" width="100%" height="100%" creationPolicy="all"  >
					
	<mx:Canvas id="piano1" height="100%" width="100%" label="Chart Builder 1"  >
		<mx:Label id="cnvs1_lblChartType" name="cnvs1_lblChartType" x="2" y="10" text="Chart type :"/>
		<mx:ComboBox id="cnvs1_cbChartType" name="cnvs1_cbChartType" dataProvider="{myChart.chart.@Type}" change="changeTypeEvt(event);" prompt="Select..."   x="73" y="8"  width="160"/>
		<mx:ComboBox x="73" y="186" id="cnvs1_cbxAxis1" name="cnvs1_cbxAxis1" change="refreshChartEvent(event);" visible="false"/>
			
			<mx:ComboBox x="73" y="268" name="cnvs1_cbyAxis1" id="cnvs1_cbyAxis1" change="refreshChartEvent(event);" visible="false"/>
			<mx:HBox name="cnvs1_HBoxMinMaxx" id="cnvs1_HBoxMinMaxx" width="100%" x="4" y="248" visible="false" >
		<flexlib:HSlider  id="cnvs1_minMaxxSlider" name="cnvs1_minMaxxSlider" 
							trackHighlightSkin="flexlib.skins.SliderThumbHighlightSkin"
							allowTrackClick="true" allowThumbOverlap="true" 
							liveDragging="true" 
							showDataTip="true"  dataTipPlacement="bottom" dataTipOffset="3"
							showTrackHighlight="true"
							thumbCount="2"  width="100%" change="refreshChartEvent(event);"
							snapInterval=".1" visible="false"  maximum="{maxxSlideValue}" 
							values="{[0, maxxSlideDefault]}"
							
						/>
		</mx:HBox>
		
		
		<mx:HBox name="cnvs1_HBoxMinMaxy" id="cnvs1_HBoxMinMaxy" width="100%" x="4" y="345"  visible="false">
		<flexlib:HSlider  id="cnvs1_minMaxySlider" 
							name="cnvs1_minMaxySlider"
							trackHighlightSkin="flexlib.skins.SliderThumbHighlightSkin"
							allowTrackClick="true" allowThumbOverlap="true" 
							liveDragging="true" 
							showDataTip="true"  dataTipPlacement="bottom" dataTipOffset="3"
							showTrackHighlight="true"
							thumbCount="2"  width="100%" change="refreshChartEvent(event);"
							snapInterval=".1" visible="false" minimum="0" maximum="{maxySlideValue}" 
							values="{[0, maxySlideDefault]}"
							
						/>
		</mx:HBox>
		
	</mx:Canvas>
	
	</mx:Accordion>
	</mx:VBox>
	</mx:HBox>
	
	<mx:Canvas id="p1" borderStyle="solid" borderColor="#CCCCCC" width="100%" height="100%" 
		horizontalScrollPolicy="off" verticalScrollPolicy="off" 
		  >
	
	</mx:Canvas>
	</mx:HBox>

<mx:states>
       <mx:State name="showCntrlPanel">
			<mx:SetProperty target="{sideBar}" name="width" value="300"/>
			<mx:SetStyle target="{DivNavRB}" name="horizontalGap" value="5"/>
       </mx:State>        
		<mx:State name="hideCntrlPanel">
			<mx:SetProperty target="{sideBar}" name="width" value="17"/>
			<mx:SetStyle target="{DivNavRB}" name="horizontalGap" value="0"/>
		</mx:State>
	</mx:states>
	<mx:transitions>
		<mx:Transition fromState="*" toState="*">
			<mx:Resize target="{sideBar}" />
		</mx:Transition>
	</mx:transitions>


</mx:Canvas>